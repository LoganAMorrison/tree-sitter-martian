================================================================================
Finalize
================================================================================

#
# @include "_metrics_util_stage_defs.mro"
#

#
# Copyright (c) 2022 10X Genomics, Inc. All rights reserved.
#

filetype json;
filetype csv;
#
# @include "metric_calculator_cs.mro"
#

filetype csv;
filetype str;
filetype json;
filetype zarr.zip;
filetype zarr.mzip;
filetype html;
filetype zarr;
filetype h5;
filetype ome.tif;
filetype pkl;
filetype png;
filetype jpg;
#
# @include "insitu/_decoding_type_defs.mro"
#

#
# Copyright (c) 2022 10X Genomics, Inc. All rights reserved.
#

filetype json;
filetype json.zip;
filetype zarr;
filetype zarr.zip;
filetype zarr.mzip;
filetype png;
filetype png.zip;
filetype csv;
filetype html;
filetype npz;
filetype ome.tif;
filetype pkl;
filetype tar;
filetype csv.gz;
filetype parquet;
#
# @include "_compute_apt_metrics_dx.mro"
#

filetype json;
filetype csv.gz;
filetype zarr.zip;
#
# @include "metric_calculator_dx.mro"
#

filetype json;
filetype pkl;
filetype zarr.zip;
filetype zarr.mzip;
filetype png.zip;
filetype png;
filetype h5;
#
# @include "_segmentation_stages.mro"
#

filetype str;
#
# @include "segmentation.mro"
#

filetype str;
#
# @include "_create_aux_outputs_cs.mro"
#

filetype html;
filetype json;
filetype ome.tif;
filetype zarr.zip;
filetype jpg;
#
# @include "_diagnostics.mro"
#

#
# Copyright (c) 2022 10X Genomics, Inc. All rights reserved.
#

filetype html;
filetype zarr.zip;
#
# @include "insitu/_insitu_counter_defs.mro"
#

filetype h5;
filetype zarr;
#
# @include "rna/_cr_ana_stages.mro"
#

#
# Copyright (c) 2021 10X Genomics, Inc. All rights reserved.
#
# Code generated by cr_ana.  DO NOT EDIT.
#

filetype bincode.lz4;
filetype h5;
filetype npy;
#
# @include "rna/_run_kmeans.mro"
#

filetype h5;
#
# @include "insitu_analyzer.mro"
#

filetype json;
filetype h5;
#
# @include "insitu_counter_core.mro"
#

filetype zarr;
filetype json;
filetype str;
filetype csv.gz;
filetype h5;
filetype zarr.zip;
filetype zarr.zip;
filetype csv;
filetype html;
filetype ome.tif;
filetype parquet;
filetype pkl;
#
# @include "_create_metrics_summary_csv_cs.mro"
#

# Copyright (c) 2022 10X Genomics, Inc. All rights reserved.

filetype csv;
filetype json;
#
# @include "insitu/_xenium_ranger_common.mro"
#

filetype csv;
filetype csv.gz;
filetype h5;
filetype html;
filetype json;
filetype ome.tif;
filetype parquet;
filetype zarr.zip;
filetype tiff;
filetype jpg;
#
# @include "_format_outputs.mro"
#

filetype html;
filetype json;
filetype ome.tif;
filetype zarr.zip;
filetype jpg;
#
# @include "_make_output_manifest.mro"
#

filetype json;
#
# @include "_websummary_stages_cs.mro"
#

filetype h5;
filetype html;
filetype json;
filetype zarr.zip;
filetype zarr.mzip;
filetype png;
filetype jpg;
#
# @include "_rna_deduplicator.mro"
#

filetype str;
filetype png.zip;
#
# @include "_store_rna_dataset.mro"
#

filetype zarr.zip;
filetype zarr.mzip;
filetype json;
#
# @include "_websummary_stages_dx.mro"
#

filetype h5;
filetype html;
filetype json;
filetype zarr.zip;
filetype zarr.mzip;
filetype png.zip;
#
# @include "insitu/pa_finalize.mro"
#

filetype tiff;

#
# @include "insitu/_decoding_type_defs.mro"
#

struct SegTile(
    npz  rle_list,
    npz  row_col_idx,
    npz  vertices,
    npz  num_vertices,
    npz  z_levels,
    json tile_parameters,
)

# Structure containing parameters for SEGMENT_CELLS
struct SegmentationParams(
    # Maximum number of polygon vertices
    int   max_vertices,
    # Parameter specifying how much simplification can be performed on the
    # final polygons
    float simplify_epsilon,
    # Minimum diameter for nuclear segmentation
    float min_diameter_um,
    # Maximum diameter for expansion nuclear segmentation
    float max_diameter_um,
    # Expansion distance for expansion nuclear segmentation
    float expansion_dist_um,
    # Minimum pixel intensity
    float dapi_filter_pe,
)

struct MorphologyPyramidBuilderOutput(
    json      estimate_fov_pos_summary,
    json      make_morphology_pyramid_summary,
    ome.tif   morphology,
    ome.tif   morphology_mip,
    ome.tif   morphology_focus,
    json      pyramid_manifest,
    zarr.zip  morpho_transform_dataset,
    zarr.mzip stitching_summary,
)

struct SegOutput(
    zarr.zip cell_segmentation_dataset,
    csv.gz   cell_boundaries_csv       "Cell segmentation cell polygons CSV"        "cell_boundaries.csv.gz",
    csv.gz   nucleus_boundaries_csv    "Cell segmentation nucleus polygons CSV"     "nucleus_boundaries.csv.gz",
    parquet  cell_boundaries_pq        "Cell segmentation cell polygons parquet"    "cell_boundaries.parquet",
    parquet  nucleus_boundaries_pq     "Cell segmentation nucleus polygons parquet" "nucleus_boundaries.parquet",
    json     cell_seg_summary,
)

struct DecodingPlan(
    json     decoding_input,
    zarr.zip imaging_manifest,
    json     external_locations,
    json     mem_model_features,
)

struct StageStdOutput(
    json    metrics,
    json    report_sections,
    png.zip report_figures,
)

struct ExecutionOptions(
    int maximum_chunks,
    int blob_finder_min_batch_size,
    int image_qc_min_batch_size,
    int point_cloud_registerer_min_batch_size,
    int make_image_pyramid_min_batch_size,
    int preprocess_for_stitching_min_batch_size,
    int register_morphology_cycles_min_batch_size,
)

struct FileLink(
    string label,
    string short_label,
    file   target,
)

struct UrlLink(
    string label,
    string short_label,
    string target,
)

struct ImagingVolumeCoordinates(
    int    cycle_index,
    int    scan_index,
    string fov_name,
    string channel_name,
)

struct ImagingCycleScanFov(
    int    cycle_index,
    int    scan_index,
    string fov_name,
)

#
# @include "_aggregate_metrics.mro"
#

struct MetricsCsvs(
    csv foveted,
    csv global_scan,
    csv global_blobs,
    csv global_codeword_blobs,
)

#
# @include "_diagnostics.mro"
#

# Structure for all ouputs associated with diagnostics
struct DiagnosticsOutput(
    zarr.zip decoding_diagnostics_dataset,
    html     web_summary,
)

#
# @include "insitu/_insitu_counter_defs.mro"
#

# Structure holding potentially pre-computed results
struct PreComputedResults(
    zarr transcript_assignments,
)

#
# @include "rna/_cr_ana_stages.mro"
#

struct PcaOutputs(
    h5   pca_h5,
    path pca_csv,
)

#
# @include "insitu/_xenium_ranger_common.mro"
#

struct XeniumRangerPayload(
    json mem_model_features,
    json sample_sheet,
    json fov_json,
    jpg  resized_overview_image,
    json summary_cs,
    json gene_panel,
    json pyramid_manifest,
    json segmentation_plan,
    json xenium_ranger_table,
)

# Struct containing parameters for xeniumranger resegment
# this struct is a superset of SegmentationParams struct
struct ResegmentParams(
    # If true, use input nuclei instead of resegmenting nuclei
    bool  resegment_nuclei,
    # Maximum number of polygon vertices
    int   max_vertices,
    # Parameter specifying how much simplification can be performed on the
    # final polygons
    float simplify_epsilon,
    # Minimum diameter for nuclear segmentation
    float min_diameter_um,
    # Maximum diameter for expansion nuclear segmentation
    float max_diameter_um,
    # Expansion distance for expansion nuclear segmentation
    float expansion_dist_um,
    # Minimum pixel intensity.
    float dapi_filter_pe,
)

# Struct containing parameters for xeniumranger relabel
struct RelabelParams(
    # Gene panel to use for relabel
    json gene_panel,
)

# Struct containing parameters for xeniumranger import-segmentation
struct ImportSegParams(
    # Importing segmentations
    file   nuclei                "3rd party nuclear polygons",
    file   cells                 "3rd party cell polygons",
    string spatial_units         "Units of the imported polygons",
    # Importing transcripts
    csv    transcript_assignment "3rd party transcript assignments",
    json   viz_polygons          "Polygons file for visualization only",
    # Common parameters
    float  expansion_dist_um     "Expansion distance for cell segmentation",
    float  min_nucleus_area_um2  "Min nucleus area in microns squared",
    float  max_nucleus_area_um2  "Max nucleus area microns squared",
    float  min_cell_area_um2     "Min cell area in microns squared",
    float  max_cell_area_um2     "Max cell area microns squared",
    int    max_vertices          "Maximum number of polygon vertices",
    float  simplify_epsilon      "Minimum distance between polygon vertices and segments",
    csv    coordinate_transform  "File containing matrix transform from physical into pixel space.",
)

struct XrRunData(
    string run_id,
    string run_timestamp,
    string software_version,
    string command_line,
    string original_software_version,
)

# CS aux outputs organized into a struct
struct AuxOutputs(
    json      fov_locations,
    map<tiff> per_cycle_channel_images,
)

struct OutputBundle(
    csv        metrics_summary,
    zarr.zip   transcripts,
    csv.gz     transcript_info_csv          "Transcript info CSV"                        "transcripts.csv.gz",
    parquet    transcript_info_pq           "Transcript info parquet"                    "transcripts.parquet",
    csv.gz     cell_info_csv                "Cell info CSV"                              "cells.csv.gz",
    parquet    cell_info_pq                 "Cell info parquet"                          "cells.parquet",
    zarr.zip   cell_segmentation            "Cell segmentation result"                   "cells.zarr.zip",
    csv.gz     nucleus_boundaries_csv       "Cell segmentation nucleus polygons CSV"     "nucleus_boundaries.csv.gz",
    csv.gz     cell_boundaries_csv          "Cell segmentation cell polygons CSV"        "cell_boundaries.csv.gz",
    parquet    nucleus_boundaries_pq        "Cell segmentation nucleus polygons parquet" "nucleus_boundaries.parquet",
    parquet    cell_boundaries_pq           "Cell segmentation cell polygons parquet"    "cell_boundaries.parquet",
    zarr.zip   analysis_zarr_zip            "Clustering result in zarr.zip format"       "analysis.zarr.zip",
    zarr.zip   cell_feature_matrix_zarr_zip "Cell-feature matrix in zarr.zip format"     "cell_feature_matrix.zarr.zip",
    h5         cell_feature_matrix_h5       "Cell-feature matrix in h5 format"           "cell_feature_matrix.h5",
    ome.tif    morphology,
    ome.tif    morphology_mip,
    ome.tif    morphology_focus,
    json       experiment_xenium            "Metadata for Xenium Explorer"               "experiment.xenium",
    html       web_summary                  "Customer-facing web summary"                "analysis_summary.html",
    path       cell_feature_matrix_mtx      "Cell-feature matrix in MEX format"          "cell_feature_matrix",
    path       analysis_csv                 "Clustering result in csv format"            "analysis",
    AuxOutputs aux_outputs                  "Auxiliary output files",
    json       gene_panel                   "Gene panel JSON",
)

# minimal subset of OutputBundle needed for Xenium Ranger to function.
struct XrMinBundle(
    csv        metrics_summary,
    zarr.zip   transcripts,
    zarr.zip   cell_segmentation "Cell segmentation result"     "cells.zarr.zip",
    ome.tif    morphology,
    ome.tif    morphology_mip,
    ome.tif    morphology_focus,
    json       experiment_xenium "Metadata for Xenium Explorer" "experiment.xenium",
    html       web_summary       "Customer-facing web summary"  "analysis_summary.html",
    AuxOutputs aux_outputs       "Auxiliary output files",
    json       gene_panel        "Gene panel JSON",
)

#
# @include "_point_cloud_registerer.mro"
#

struct RegisterDAPIChunkInput(
    int    cycle_index,
    string fov_name,
)

#
# @include "_rna_deduplicator.mro"
#

struct FoVPairChunkInput(
    string fov_name0,
    string fov_name1,
    string orientation,
)

struct DedupDebugStats(
    float  registration_offsets_x,
    float  registration_offsets_y,
    int    n_rnas0,
    int    n_rnas1,
    int    n_point_pairs,
    int    n_inliers,
    float  rmse,
    int    n_deduplication,
    string orientation,
)

struct DeduplicationStageBags(
    StageStdOutput[] deduplicate_rna_hv,
    StageStdOutput[] deduplicate_rna_diag,
    StageStdOutput[] finalize_rna_deduplication,
)

#
# @include "_metrics_util_stage_defs.mro"
#

stage SIMPLE_MERGE_METRICS(
    in  json[] summaries,
    out json   summary,
    src py     "./stages/metrics/simple_merge_metrics",
) using (
    mem_gb   = 8,
    volatile = strict,
)

stage SIMPLE_METRICS_TO_CSV(
    in  json summary,
    out csv  metrics,
    src py   "./stages/metrics/simple_metrics_to_csv",
) using (
    mem_gb   = 8,
    volatile = strict,
)

#
# @include "metric_calculator_cs.mro"
#

pipeline METRIC_CALCULATOR_CS(
    in  json     mem_model_features,
    in  zarr.zip cells,
    in  zarr.zip transcripts,
    in  h5       matrix,
    in  ome.tif  morphology_image,
    in  json     gene_panel,
    in  json     sample_sheet,
    in  bool     is_add_on_panel,
    in  string   calibration_uuid,
    in  json     input_metrics,
    in  jpg      resized_overview_image,
    in  string   xr_run_id,
    out json     summary,
    out json     details,
)
{
    call GENERATE_DECODING_METRICS_CS(
        mem_model_features = self.mem_model_features,
        matrix             = self.matrix,
        cells              = self.cells,
        transcripts        = self.transcripts,
        input_metrics      = self.input_metrics,
        is_add_on_panel    = self.is_add_on_panel,
    )

    call GENERATE_CELL_METRICS(
        mem_model_features = self.mem_model_features,
        matrix             = self.matrix,
        cells              = self.cells,
        transcripts        = self.transcripts,
        is_add_on_panel    = self.is_add_on_panel,
    )

    # TODO need to move the core of this into a method called by GENERATE_WEB_SUMMARY_CS
    # also, need to move the "hidden" calibration zarr path stuff into the `summary_cs.json`
    call GENERATE_SAMPLE_METRICS(
        mem_model_features     = self.mem_model_features,
        transcripts            = self.transcripts,
        gene_panel             = self.gene_panel,
        sample_sheet           = self.sample_sheet,
        summary                = GENERATE_DECODING_METRICS_CS.summary,
        calibration_uuid       = self.calibration_uuid,
        resized_overview_image = self.resized_overview_image,
        xr_run_id              = self.xr_run_id,
    )

    call GENERATE_MORPHOLOGY_PLOTS(
        mem_model_features = self.mem_model_features,
        morphology_image   = self.morphology_image,
    )

    call SIMPLE_MERGE_METRICS as MERGE_METRICS(
        summaries = [
            GENERATE_CELL_METRICS.summary,
            GENERATE_DECODING_METRICS_CS.summary,
            GENERATE_MORPHOLOGY_PLOTS.summary,
            GENERATE_SAMPLE_METRICS.summary,
        ],
    )

    call SIMPLE_MERGE_METRICS as MERGE_DETAILS(
        summaries = [
            GENERATE_CELL_METRICS.details,
            GENERATE_MORPHOLOGY_PLOTS.details,
            GENERATE_SAMPLE_METRICS.details,
            GENERATE_DECODING_METRICS_CS.details,
        ],
    )

    return (
        summary = MERGE_METRICS.summary,
        details = MERGE_DETAILS.summary,
    )
}

stage GENERATE_DECODING_METRICS_CS(
    in  json     mem_model_features,
    in  h5       matrix,
    in  zarr.zip cells,
    in  zarr.zip transcripts,
    in  json     input_metrics,
    in  bool     is_add_on_panel,
    out json     summary,
    out json     fov_summary,
    out json     details,
    out html     report,
    src py       "./stages/metrics/generate_decoding_metrics_cs",
) split (
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

stage GENERATE_SAMPLE_METRICS(
    in  json     mem_model_features,
    in  zarr.zip transcripts,
    in  json     gene_panel,
    in  json     sample_sheet,
    in  json     summary,
    in  jpg      resized_overview_image,
    in  string   calibration_uuid,
    in  string   xr_run_id,
    out json     summary,
    out json     details,
    src py       "./stages/metrics/generate_sample_metrics",
) split (
) using (
    mem_gb   = 8,
    volatile = strict,
)

stage GENERATE_MORPHOLOGY_PLOTS(
    in  json    mem_model_features,
    in  ome.tif morphology_image,
    out json    summary,
    out json    details,
    src py      "./stages/metrics/generate_morphology_plots",
) split (
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

stage GENERATE_CELL_METRICS(
    in  json     mem_model_features,
    in  h5       matrix,
    in  zarr.zip cells,
    in  zarr.zip transcripts,
    in  bool     is_add_on_panel,
    out json     summary,
    out json     details,
    out html     report,
    src py       "./stages/metrics/generate_cell_metrics",
) split (
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "_compute_apt_metrics_dx.mro"
#

stage COMPUTE_APT_METRICS_DX(
    in  DecodingPlan decoding_plan,
    in  csv.gz       transcript_info_csv,
    in  path         analysis_csv,
    out json         summary,
    src py           "stages/metrics/compute_apt_metrics_dx",
) split (
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
) retain (
    summary,
)

#
# @include "metric_calculator_dx.mro"
#

pipeline METRIC_CALCULATOR_DX(
    in  DecodingPlan decoding_plan,
    in  zarr.mzip    rna_dataset_with_dups,
    in  zarr.mzip    rna_dataset_without_dups,
    in  zarr.mzip    blob_dataset,
    in  zarr.zip     transform_dataset,
    in  zarr.zip     cell_segmentation_dataset,
    in  zarr.zip     z_bounds_dataset,
    in  json         pyramid_manifest,
    in  json         morpho_pyramid_summary,
    in  bool         is_pd,
    in  path         analysis_csv,
    in  csv.gz       transcript_info_csv,
    in  h5           matrix_h5,
    out zarr.zip     decoding_diagnostics_dataset,
    out json         summary,
    out json         fov_summary,
    out json         roll_off_details,
    out json         codeword_plot_details,
    out path         spatial_plots,
    out bool         is_add_on_panel,
)
{
    call GENERATE_DECODING_DIAGNOSTICS(
        decoding_plan             = self.decoding_plan,
        # TODO(logan.morrison): Check that the duplicated RNA dataset is okay
        rna_dataset               = self.rna_dataset_with_dups,
        blob_dataset              = self.blob_dataset,
        z_bounds_dataset          = self.z_bounds_dataset,
        transform_dataset         = self.transform_dataset,
        cell_segmentation_dataset = self.cell_segmentation_dataset,
        pyramid_manifest          = self.pyramid_manifest,
    )

    call GENERATE_DECODING_METRICS(
        decoding_plan          = self.decoding_plan,
        rnas                   = self.rna_dataset_without_dups,
        cells                  = self.cell_segmentation_dataset,
        # todo(Peter) redundant?
        rcp_blob_summary       = GENERATE_DECODING_DIAGNOSTICS.summary,
        dx_summary             = GENERATE_DECODING_DIAGNOSTICS.summary,
        morpho_pyramid_summary = self.morpho_pyramid_summary,
        is_pd                  = self.is_pd,
        matrix_h5              = self.matrix_h5,
    )

    call GENERATE_SPATIAL_PLOTS(
        decoding_plan        = self.decoding_plan,
        rnas                 = self.rna_dataset_without_dups,
        cell_background_plot = null,
        make_pd_plots        = false,
        pyramid_manifest     = self.pyramid_manifest,
    )

    call COMPUTE_APT_METRICS_DX(
        decoding_plan       = self.decoding_plan,
        analysis_csv        = self.analysis_csv,
        transcript_info_csv = self.transcript_info_csv,
    )

    call SIMPLE_MERGE_METRICS as MERGE_METRICS(
        summaries = [
            GENERATE_DECODING_METRICS.summary,
            GENERATE_DECODING_DIAGNOSTICS.summary,
            COMPUTE_APT_METRICS_DX.summary,
        ],
    )

    return (
        decoding_diagnostics_dataset = GENERATE_DECODING_DIAGNOSTICS.decoding_diagnostics_dataset,
        summary                      = MERGE_METRICS.summary,
        fov_summary                  = GENERATE_DECODING_DIAGNOSTICS.fov_summary,
        roll_off_details             = GENERATE_DECODING_DIAGNOSTICS.roll_off_details,
        spatial_plots                = GENERATE_SPATIAL_PLOTS.spatial_plots,
        is_add_on_panel              = GENERATE_DECODING_METRICS.is_add_on_panel,
        codeword_plot_details        = GENERATE_DECODING_METRICS.details,
    )
}

stage GENERATE_DECODING_METRICS(
    in  DecodingPlan decoding_plan,
    in  zarr.mzip    rnas,
    in  zarr.zip     cells,
    in  json         rcp_blob_summary,
    in  json         dx_summary,
    in  json         morpho_pyramid_summary,
    in  bool         is_pd,
    in  h5           matrix_h5,
    out json         summary,
    out json         fov_summary,
    out json         details,
    out html         report,
    out bool         is_add_on_panel,
    src py           "./stages/metrics/generate_decoding_metrics",
) split (
    in  string       fov_name,
    out pkl          per_cycle_metrics,
    out pkl          per_fov_metrics,
    out string       intensity_units,
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

stage GENERATE_DECODING_DIAGNOSTICS(
    in  DecodingPlan decoding_plan,
    in  zarr.mzip    rna_dataset,
    in  zarr.mzip    blob_dataset,
    in  zarr.zip     transform_dataset,
    in  zarr.zip     cell_segmentation_dataset,
    in  zarr.zip     z_bounds_dataset,
    in  json         pyramid_manifest,
    out zarr.zip     decoding_diagnostics_dataset,
    out json         summary,
    out json         fov_summary,
    out json         roll_off_details,
    src py           "./stages/diagnostics/generate_decoding_diagnostics",
) split (
    in  string       fov_name,
    # metrics that are aggregated in the join, like histograms
    out pkl          per_cycle_metrics,
    # per fov metrics from chunks
    out pkl          per_fov_metrics,
    # pass intensity units to avoid loading blob dataset in the join
    out string       intensity_units,
) using (
    mem_gb   = 6,
    vmem_gb  = 16384,
    volatile = strict,
)

stage GENERATE_SPATIAL_PLOTS(
    in  DecodingPlan decoding_plan,
    in  zarr.mzip    rnas,
    in  bool         make_pd_plots,
    in  png          cell_background_plot,
    in  json         pyramid_manifest,
    out path         spatial_plots,
    src py           "./stages/metrics/generate_spatial_plots",
) split (
) using (
    mem_gb   = 1,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "_process_cycle_stage_defs.mro"
#

stage POPULATE_DECODING_PLAN(
    in  DecodingPlan unpopulated_decoding_plan,
    in  string       scan_record_uri,
    out DecodingPlan decoding_plan,
    out int          cycle_ix,
    out zarr.zip     cycle_image_transforms,
    out json         cycle_metadata,
    out bool         disable_rna_processing,
    out bool         disable_dapi_processing,
    out path         cycle_stage_positions_csv_dir,
    src py           "stages/pa_populate_decoding_plan",
) using (
    mem_gb   = 4,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "_segmentation_stages.mro"
#

# segmentation stages, minus a few preflight stages
# stages in this file should not depend on the decoder_input

stage STITCH_SEGMENTATION(
    in  json        mem_model_features,
    in  ome.tif     morphology,
    in  json        pyramid_manifest,
    in  SegTile[][] seg_parts_list,
    out zarr.zip    nuclei_segmentation_dataset,
    out json        summary,
    src py          "stages/stitch_segmentation",
) split (
) using (
    mem_gb   = 4,
    vmem_gb  = 16384,
    volatile = strict,
)

stage SEGMENT_CELLS(
    in  json               mem_model_features,
    in  int                seg_partition_cycle_ix,
    in  json               segmentation_plan,
    in  SegmentationParams segmentation_params,
    in  ome.tif            morphology,
    in  json               pyramid_manifest,
    out SegTile[]          seg_parts_list,
    src py                 "stages/segment_cells",
) split (
    in  int                cycle_id,
    in  str                nuclei_channel_name,
    in  int                tile_id_x,
    in  int                tile_id_y,
    in  int                tile_width,
    in  int                tile_height,
    in  int                tile_overlap,
    in  float              zstep_um,
    in  float              scale,
    in  float              min_nuclear_area_px,
    in  float              max_nuclear_area_px,
    in  path               model_path,
    in  int                max_vertices,
    in  float              simplify_epsilon,
    in  int                cache_block_size,
    in  int                cache_number_blocks,
    in  float              dapi_filter_pe,
    out npz                rle_list,
    out npz                row_col_idx,
    out npz                vertices,
    out npz                num_vertices,
    out npz                z_levels,
    out npz                areas,
    out npz                centroids,
    out json               tile_parameters,
) using (
    mem_gb   = 8,
    vmem_gb  = 16384,
    volatile = strict,
)

stage EXPAND_NUCLEI(
    in  json     mem_model_features,
    in  ome.tif  morphology,
    in  json     pyramid_manifest,
    in  zarr.zip nuclei_dataset,
    in  int      max_vertices,
    in  float    simplify_epsilon,
    in  float    expansion_dist_um,
    out zarr.zip cell_segmentation_dataset  "Cell segmentation result"  "cells.zarr.zip",
    out csv.gz   cell_boundaries_csv        "Cell segmentation cell polygons CSV"  "cell_boundaries.csv.gz",
    out csv.gz   nucleus_boundaries_csv     "Cell segmentation nucleus polygons CSV"  "nucleus_boundaries.csv.gz",
    out parquet  cell_boundaries_pq         "Cell segmentation cell polygons parquet"  "cell_boundaries.parquet",
    out parquet  nucleus_boundaries_pq      "Cell segmentation nucleus polygons parquet"  "nucleus_boundaries.parquet",
    src py       "stages/expand_nuclei",
) split (
    in  int      tile_x,
    in  int      tile_y,
    in  int      tile_dx,
    in  int      tile_dy,
    in  int      tile_overlap,
    in  int      exclude_top,
    in  int      exclude_bot,
    in  int      exclude_left,
    in  int      exclude_right,
    in  int      expansion_dist_px,
    out npz      rle_list,
    out npz      row_col_idx,
    out npz      vertices,
    out npz      num_vertices,
    out npz      labels,
    out npz      areas,
    out npz      centroids,
) using (
    mem_gb   = 4,
    vmem_gb  = 16384,
    volatile = strict,
)

stage WRITE_CELL_NUCLEI_BOUNDARIES_FILES(
    in  json     mem_model_features,
    in  zarr.zip cells,
    out csv.gz   cell_boundaries_csv     "Cell segmentation cell polygons CSV"  "cell_boundaries.csv.gz",
    out csv.gz   nucleus_boundaries_csv  "Cell segmentation nucleus polygons CSV"  "nucleus_boundaries.csv.gz",
    out parquet  cell_boundaries_pq      "Cell segmentation cell polygons parquet"  "cell_boundaries.parquet",
    out parquet  nucleus_boundaries_pq   "Cell segmentation nucleus polygons parquet"  "nucleus_boundaries.parquet",
    src py       "stages/write_cell_nuclei_boundaries_files",
) split (
) using (
    mem_gb   = 4,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "segmentation.mro"
#

pipeline PA_SEGMENT(
    in  DecodingPlan                     setup_decoding_plan,
    in  MorphologyPyramidBuilderOutput[] seg_input_list,
    in  string                           scan_record_uri,
    out SegTile[]                        seg_parts_list,
)
{
    call PA_SEGMENT_PREFLIGHT(
        setup_decoding_plan = self.setup_decoding_plan,
        seg_input_list      = self.seg_input_list,
        scan_record_uri     = self.scan_record_uri,
    ) using (
        preflight = true,
    )

    call POPULATE_DECODING_PLAN(
        unpopulated_decoding_plan = self.setup_decoding_plan,
        scan_record_uri           = self.scan_record_uri,
    )

    call PLAN_SEGMENTATION(
        decoding_plan  = POPULATE_DECODING_PLAN.decoding_plan,
        seg_input_list = self.seg_input_list,
        cycle_ix       = POPULATE_DECODING_PLAN.cycle_ix,
    )

    call SEGMENT_CELLS(
        mem_model_features     = self.setup_decoding_plan.mem_model_features,
        morphology             = PLAN_SEGMENTATION.morphology,
        pyramid_manifest       = PLAN_SEGMENTATION.pyramid_manifest,
        seg_partition_cycle_ix = POPULATE_DECODING_PLAN.cycle_ix,
        segmentation_plan      = PLAN_SEGMENTATION.segmentation_plan,
        segmentation_params    = PLAN_SEGMENTATION.segmentation_params,
    ) using (
        disabled = PLAN_SEGMENTATION.disable_seg,
    )

    return (
        seg_parts_list = SEGMENT_CELLS.seg_parts_list,
    )
}

pipeline PA_SEGMENT_FINALIZE(
    in  DecodingPlan                     setup_decoding_plan,
    in  MorphologyPyramidBuilderOutput[] seg_input_list,
    in  SegTile[][]                      seg_parts_list,
    in  string                           scan_record_uri,
    out SegOutput                        seg_output,
)
{
    call PA_SEGMENT_FINALIZE_PREFLIGHT(
        setup_decoding_plan = self.setup_decoding_plan,
        seg_input_list      = self.seg_input_list,
        seg_parts_list      = self.seg_parts_list,
        scan_record_uri     = self.scan_record_uri,
    ) using (
        preflight = true,
    )

    call POPULATE_DECODING_PLAN(
        unpopulated_decoding_plan = self.setup_decoding_plan,
        scan_record_uri           = self.scan_record_uri,
    )

    call PLAN_SEGMENTATION(
        decoding_plan  = POPULATE_DECODING_PLAN.decoding_plan,
        seg_input_list = self.seg_input_list,
        cycle_ix       = POPULATE_DECODING_PLAN.cycle_ix,
    )

    call STITCH_SEGMENTATION(
        mem_model_features = POPULATE_DECODING_PLAN.decoding_plan.mem_model_features,
        morphology         = PLAN_SEGMENTATION.morphology,
        pyramid_manifest   = PLAN_SEGMENTATION.pyramid_manifest,
        seg_parts_list     = self.seg_parts_list,
    ) using (
        disabled = PLAN_SEGMENTATION.disable_seg_finalize,
    )

    call EXPAND_NUCLEI(
        mem_model_features = POPULATE_DECODING_PLAN.decoding_plan.mem_model_features,
        morphology         = PLAN_SEGMENTATION.morphology,
        pyramid_manifest   = PLAN_SEGMENTATION.pyramid_manifest,
        nuclei_dataset     = STITCH_SEGMENTATION.nuclei_segmentation_dataset,
        max_vertices       = PLAN_SEGMENTATION.segmentation_params.max_vertices,
        simplify_epsilon   = PLAN_SEGMENTATION.segmentation_params.simplify_epsilon,
        expansion_dist_um  = PLAN_SEGMENTATION.segmentation_params.expansion_dist_um,
    ) using (
        disabled = PLAN_SEGMENTATION.disable_seg_finalize,
    )

    return (
        seg_output = {
            cell_boundaries_csv:       EXPAND_NUCLEI.cell_boundaries_csv,
            cell_boundaries_pq:        EXPAND_NUCLEI.cell_boundaries_pq,
            cell_seg_summary:          STITCH_SEGMENTATION.summary,
            cell_segmentation_dataset: EXPAND_NUCLEI.cell_segmentation_dataset,
            nucleus_boundaries_csv:    EXPAND_NUCLEI.nucleus_boundaries_csv,
            nucleus_boundaries_pq:     EXPAND_NUCLEI.nucleus_boundaries_pq,
        },
    )
}

pipeline MORPHOLOGY_SEGMENTER(
    in  DecodingPlan                   decoding_plan,
    in  MorphologyPyramidBuilderOutput morpho_builder_out,
    out SegOutput                      seg_output,
)
{
    call PLAN_SEGMENTATION(
        decoding_plan  = self.decoding_plan,
        seg_input_list = [self.morpho_builder_out],
        cycle_ix       = -1,
    )

    map call SEGMENT_CELLS(
        seg_partition_cycle_ix = split PLAN_SEGMENTATION.seg_partition_cycle_ixs,
        mem_model_features     = self.decoding_plan.mem_model_features,
        morphology             = PLAN_SEGMENTATION.morphology,
        pyramid_manifest       = PLAN_SEGMENTATION.pyramid_manifest,
        segmentation_plan      = PLAN_SEGMENTATION.segmentation_plan,
        segmentation_params    = PLAN_SEGMENTATION.segmentation_params,
    )

    call STITCH_SEGMENTATION(
        mem_model_features = self.decoding_plan.mem_model_features,
        morphology         = PLAN_SEGMENTATION.morphology,
        pyramid_manifest   = PLAN_SEGMENTATION.pyramid_manifest,
        seg_parts_list     = SEGMENT_CELLS.seg_parts_list,
    )

    call EXPAND_NUCLEI(
        mem_model_features = self.decoding_plan.mem_model_features,
        morphology         = PLAN_SEGMENTATION.morphology,
        pyramid_manifest   = PLAN_SEGMENTATION.pyramid_manifest,
        nuclei_dataset     = STITCH_SEGMENTATION.nuclei_segmentation_dataset,
        # TODO(Peter) we can just have it take the segmentation_params directly
        max_vertices       = PLAN_SEGMENTATION.segmentation_params.max_vertices,
        simplify_epsilon   = PLAN_SEGMENTATION.segmentation_params.simplify_epsilon,
        expansion_dist_um  = PLAN_SEGMENTATION.segmentation_params.expansion_dist_um,
    )

    return (
        seg_output = {
            cell_boundaries_csv:       EXPAND_NUCLEI.cell_boundaries_csv,
            cell_boundaries_pq:        EXPAND_NUCLEI.cell_boundaries_pq,
            cell_seg_summary:          STITCH_SEGMENTATION.summary,
            cell_segmentation_dataset: EXPAND_NUCLEI.cell_segmentation_dataset,
            nucleus_boundaries_csv:    EXPAND_NUCLEI.nucleus_boundaries_csv,
            nucleus_boundaries_pq:     EXPAND_NUCLEI.nucleus_boundaries_pq,
        },
    )
}

stage PA_SEGMENT_PREFLIGHT(
    in  DecodingPlan                     setup_decoding_plan,
    in  MorphologyPyramidBuilderOutput[] seg_input_list,
    in  string                           scan_record_uri,
    src py                               "stages/pa_segment_preflight",
) using (
    mem_gb   = 1,
    vmem_gb  = 16384,
    volatile = strict,
)

stage PA_SEGMENT_FINALIZE_PREFLIGHT(
    in  DecodingPlan                     setup_decoding_plan,
    in  MorphologyPyramidBuilderOutput[] seg_input_list,
    in  SegTile[][]                      seg_parts_list,
    in  string                           scan_record_uri,
    src py                               "stages/pa_segment_finalize_preflight",
) using (
    mem_gb   = 1,
    vmem_gb  = 16384,
    volatile = strict,
)

stage PLAN_SEGMENTATION(
    in  DecodingPlan                     decoding_plan,
    in  MorphologyPyramidBuilderOutput[] seg_input_list,
    in  int                              cycle_ix,
    out json                             segmentation_plan,
    out SegmentationParams               segmentation_params,
    out int[]                            seg_partition_cycle_ixs,
    out ome.tif                          morphology,
    out json                             pyramid_manifest,
    out bool                             disable_seg,
    out bool                             disable_seg_finalize,
    src py                               "stages/plan_segmentation",
) using (
    mem_gb   = 6,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "_aggregate_metrics.mro"
#

stage AGGREGATE_METRICS(
    in  DecodingPlan decoding_plan,
    # these are summary metrics that are already in final form and don't need
    # further aggregation
    in  json[]       aggregated_summaries,
    in  MetricsCsvs  codeword_metrics,
    # these are summary jsons that are in need of aggregation over cycles/channels
    in  map<json>[]  input_metric_file_lists,
    in  map<json>[]  input_fov_metric_file_lists,
    in  json         pa_setup_metadata,
    in  csv          brightness_by_gene,
    out json         per_fov_metrics,
    out path         metrics_csvs,
    out json         summary,
    out json         summary_cs,
    src py           "stages/aggregate_metrics",
) split (
) using (
    mem_gb   = 2,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "_create_aux_outputs_cs.mro"
#

stage CREATE_AUX_OUTPUTS_CS(
    in  DecodingPlan decoding_plan,
    in  json         pyramid_manifest,
    in  png          overview_nuv_image,
    out json         fov_json,
    out string       calibration_uuid,
    out string       sample_desc,
    out jpg          resized_overview_image,
    src py           "stages/create_aux_outputs_cs",
) split (
) using (
    mem_gb   = 4,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "_decode_points.mro"
#

stage BUILD_DECODING_MODEL(
    in  DecodingPlan decoding_plan,
    in  zarr.mzip    blob_dataset,
    in  zarr.zip     transform_dataset,
    out json         analog_model,
    src py           "stages/build_decoding_model",
) split (
    in  string       fov_name,
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

stage DECODE_POINTS(
    in  DecodingPlan decoding_plan,
    in  zarr.mzip    blob_dataset,
    in  zarr.zip     transform_dataset,
    in  json         analog_model,
    out zarr.mzip    rna_dataset,
    out json         summary,
    out csv          error_matrix,
    src py           "stages/decode_points",
) split (
    in  string       fov_name,
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
) retain (
    summary,
)

stage DECODE_AND_GROUP_BLOBS(
    in  DecodingPlan decoding_plan,
    in  zarr.mzip    blob_dataset,
    in  zarr.zip     transform_dataset,
    out zarr.mzip    rna_dataset,
    out json         summary,
    out json         model,
    src py           "stages/decode_and_group_blobs",
) split (
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
) retain (
    summary,
)

#
# @include "_fine_tune_registration.mro"
#

stage FINE_TUNE_REGISTRATION(
    in  DecodingPlan   decoding_plan,
    in  zarr.mzip      blob_dataset,
    in  zarr.zip       transform_dataset,
    in  json           blob_dataset_metrics,
    in  bool           dev_reporting,
    in  int            registration_reference_bit,
    out zarr.zip       fine_tuned_transform_dataset,
    out json           metrics,
    out StageStdOutput stage_bag,
    src py             "stages/fine_tune_registration",
) split (
    in  string         fov_name,
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "rna/_cr_ana_stages.mro"
#

stage RUN_DIFFERENTIAL_EXPRESSION_NG(
    in  h5          matrix_h5,
    in  h5          clustering_h5,
    in  bool        is_antibody_only,
    out h5          diffexp_h5,
    out path        diffexp_csv,
    src comp        "cr_ana martian diff_exp_stage",
) split (
    in  map[]       cluster_keys,
    out bincode.lz4 diffexp,
) using (
    volatile = strict,
)

stage RUN_GRAPH_CLUSTERING_NG(
    in  h5     matrix_h5,
    in  h5     pca_h5,
    in  int    num_neighbors,
    in  float  neighbor_a,
    in  float  neighbor_b,
    in  int    input_pcs,
    in  float  resolution,
    in  int    random_seed,
    in  bool   is_antibody_only,
    in  int    threads,
    in  bool   parallel_clustering,
    out h5     clusters_h5,
    out path   clusters_csv,
    src comp   "cr_ana martian graph_clustering_stage",
) split (
    in  string feature_type,
) using (
    mem_gb   = 1,
    threads  = 1,
    volatile = strict,
)

stage RUN_HIERARCHICAL_CLUSTERING(
    in  h5     matrix_h5,
    in  h5     graph_clusters_h5,
    in  bool   is_antibody_only,
    out h5     clusters_h5,
    out path   clusters_csv,
    src comp   "cr_ana martian hierarchical_clustering_stage",
) split (
    in  string feature_type,
) using (
    mem_gb  = 4,
    threads = 1,
)

stage RUN_PCA_NG(
    in  h5              matrix_h5,
    in  int             num_pca_genes,
    in  int             num_principal_comps,
    in  bool            is_spatial,
    in  map<PcaOutputs> pca_map,
    out h5              pca_h5,
    out path            pca_csv,
    src comp            "cr_ana martian pca_stage",
) split (
    in  string          feature_type,
) using (
    mem_gb   = 1,
    threads  = 1,
    volatile = strict,
)

stage RUN_PCA2(
    in  h5  matrix_h5,
    in  int num_pcs,
    out npy dimred_matrix,
    src comp "cr_ana martian pca2_stage",
) split (
) using (
    mem_gb   = 1,
    threads  = 1,
    volatile = strict,
)

stage RUN_TSNE_NG(
    in  h5     matrix_h5,
    in  h5     pca_h5,
    in  int    random_seed,
    in  float  perplexity,
    in  int    input_pcs,
    in  int    max_dims,
    in  int    max_iter,
    in  int    stop_lying_iter,
    in  int    mom_switch_iter,
    in  float  theta,
    in  bool   is_antibody_only,
    out h5     tsne_h5,
    out path   tsne_csv,
    src comp   "cr_ana martian tsne_stage",
) split (
    in  int    tsne_dims,
    in  string feature_type,
) using (
    mem_gb   = 1,
    threads  = 1,
    volatile = strict,
)

stage RUN_UMAP(
    in  h5     matrix_h5,
    in  h5     pca_h5,
    in  int    random_seed,
    in  int    n_neighbors,
    in  int    input_pcs,
    in  int    max_dims,
    in  float  min_dist,
    in  string metric,
    in  bool   is_antibody_only,
    in  string implementation,
    out h5     umap_h5,
    out path   umap_csv,
    src comp   "cr_ana martian umap_stage",
) split (
    in  int    umap_dims,
    in  string feature_type,
) using (
    mem_gb   = 1,
    threads  = 1,
    volatile = strict,
)

#
# @include "rna/_run_kmeans.mro"
#

stage RUN_KMEANS(
    in  h5     matrix_h5,
    in  h5     pca_h5,
    in  int    random_seed,
    in  int    max_clusters,
    in  int    num_bcs,
    in  int    num_pcs,
    out h5     kmeans_h5,
    out path   kmeans_csv,
    src py     "stages/analyzer/run_kmeans",
) split (
    in  int    n_clusters,
    in  string library,
) using (
    volatile = strict,
)

#
# @include "insitu_analyzer.mro"
#

pipeline INSITU_ANALYZER(
    in  h5   matrix_h5,
    in  bool disable_tsne,
    in  int  graphclust_threads,
    out h5   analysis_h5         "Clustering result in h5 format"  "analysis.h5",
    out path analysis_csv        "Clustering result in csv format"  "analysis",
    out bool skipped,
)
{
    call SETUP_ANALYZER(
        filtered_matrices_h5 = self.matrix_h5,
        disable_tsne         = self.disable_tsne,
    )

    call RUN_PCA_NG as RUN_PCA(
        matrix_h5           = SETUP_ANALYZER.preprocessed_matrix_h5,
        num_pca_genes       = null,
        num_principal_comps = null,
        pca_map             = null,
        is_spatial          = false,
    ) using (
        disabled = SETUP_ANALYZER.skip,
        volatile = true,
    )

    call RUN_KMEANS(
        matrix_h5    = SETUP_ANALYZER.preprocessed_matrix_h5,
        pca_h5       = RUN_PCA.pca_h5,
        random_seed  = null,
        max_clusters = null,
        num_bcs      = null,
        num_pcs      = null,
    ) using (
        disabled = SETUP_ANALYZER.skip,
        volatile = true,
    )

    call RUN_GRAPH_CLUSTERING_NG as RUN_GRAPH_CLUSTERING(
        matrix_h5           = SETUP_ANALYZER.preprocessed_matrix_h5,
        pca_h5              = RUN_PCA.pca_h5,
        num_neighbors       = null,
        neighbor_a          = null,
        neighbor_b          = null,
        input_pcs           = null,
        resolution          = null,
        random_seed         = null,
        is_antibody_only    = false,
        threads             = self.graphclust_threads,
        parallel_clustering = true,
    ) using (
        disabled = SETUP_ANALYZER.skip,
        volatile = true,
    )

    call COMBINE_CLUSTERING(
        kmeans_h5      = RUN_KMEANS.kmeans_h5,
        kmeans_csv     = RUN_KMEANS.kmeans_csv,
        graphclust_h5  = RUN_GRAPH_CLUSTERING.clusters_h5,
        graphclust_csv = RUN_GRAPH_CLUSTERING.clusters_csv,
    ) using (
        disabled = SETUP_ANALYZER.skip,
        volatile = true,
    )

    call RUN_DIFFERENTIAL_EXPRESSION_NG as RUN_DIFFERENTIAL_EXPRESSION(
        matrix_h5        = SETUP_ANALYZER.preprocessed_matrix_h5,
        clustering_h5    = COMBINE_CLUSTERING.clustering_h5,
        is_antibody_only = false,
    ) using (
        disabled = SETUP_ANALYZER.skip,
        volatile = true,
    )

    call RUN_TSNE_NG as RUN_TSNE(
        matrix_h5        = SETUP_ANALYZER.preprocessed_matrix_h5,
        pca_h5           = RUN_PCA.pca_h5,
        random_seed      = null,
        perplexity       = null,
        input_pcs        = null,
        max_dims         = null,
        max_iter         = null,
        stop_lying_iter  = null,
        mom_switch_iter  = null,
        theta            = null,
        is_antibody_only = false,
    ) using (
        disabled = SETUP_ANALYZER.skip_tsne,
        volatile = true,
    )

    call RUN_UMAP(
        matrix_h5        = SETUP_ANALYZER.preprocessed_matrix_h5,
        pca_h5           = RUN_PCA.pca_h5,
        random_seed      = null,
        n_neighbors      = null,
        input_pcs        = null,
        max_dims         = null,
        min_dist         = null,
        metric           = null,
        is_antibody_only = false,
        implementation   = "parallel",
    ) using (
        disabled = SETUP_ANALYZER.skip,
        volatile = true,
    )

    call SUMMARIZE_ANALYSIS(
        matrix_h5      = SETUP_ANALYZER.preprocessed_matrix_h5,
        pca_h5         = RUN_PCA.pca_h5,
        clustering_h5  = COMBINE_CLUSTERING.clustering_h5,
        diffexp_h5     = RUN_DIFFERENTIAL_EXPRESSION.diffexp_h5,
        tsne_h5        = RUN_TSNE.tsne_h5,
        umap_h5        = RUN_UMAP.umap_h5,
        pca_csv        = RUN_PCA.pca_csv,
        clustering_csv = COMBINE_CLUSTERING.clustering_csv,
        diffexp_csv    = RUN_DIFFERENTIAL_EXPRESSION.diffexp_csv,
        tsne_csv       = RUN_TSNE.tsne_csv,
        umap_csv       = RUN_UMAP.umap_csv,
    ) using (
        disabled = SETUP_ANALYZER.skip,
    )

    return (
        analysis_h5  = SUMMARIZE_ANALYSIS.analysis_h5,
        analysis_csv = SUMMARIZE_ANALYSIS.analysis_csv,
        skipped      = SETUP_ANALYZER.skip,
    )
}

stage COMBINE_CLUSTERING(
    in  h5   kmeans_h5,
    in  path kmeans_csv,
    in  h5   graphclust_h5,
    in  path graphclust_csv,
    out h5   clustering_h5,
    out path clustering_csv,
    src py   "./stages/analyzer/combine_clustering",
) using (
    mem_gb   = 2,
    vmem_gb  = 16384,
    volatile = strict,
)

stage SUMMARIZE_ANALYSIS(
    in  h5   matrix_h5,
    in  h5   pca_h5,
    in  h5   clustering_h5,
    in  h5   diffexp_h5,
    in  h5   tsne_h5,
    in  h5   umap_h5,
    in  path pca_csv,
    in  path clustering_csv,
    in  path diffexp_csv,
    in  path tsne_csv,
    in  path umap_csv,
    out h5   analysis_h5     "Clustering result in h5 format"  "analysis.h5",
    out path analysis_csv    "Clustering result in csv format"  "analysis",
    src py   "stages/analyzer/summarize_analysis",
) split (
) using (
    vmem_gb  = 16384,
    volatile = strict,
)

stage SETUP_ANALYZER(
    in  h5   filtered_matrices_h5,
    in  bool disable_tsne,
    out h5   preprocessed_matrix_h5,
    out bool skip,
    out bool skip_tsne,
    src py   "./stages/analyzer/setup_analyzer",
) using (
    mem_gb   = 8,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "insitu_counter_core.mro"
#

# In-situ counter pipeline
pipeline INSITU_COUNTER_CORE(
    in  json               mem_model_features,
    in  zarr.zip           transcripts,
    in  zarr.zip           cell_segmentation_dataset,
    in  json               gene_panel,
    in  h5                 cell_protein_matrix_h5,
    in  bool               disable_tsne,
    in  int                graphclust_threads,
    in  bool               disable_create_gene_matrix,
    in  float              count_min_q,
    # Pre-computed results
    in  PreComputedResults pre_computed,
    #
    out csv.gz             transcript_info_csv           "Transcript info CSV"      "transcripts.csv.gz",
    out parquet            transcript_info_pq            "Transcript info parquet"  "transcripts.parquet",
    out csv.gz             cell_info_csv                 "Cell info CSV"            "cells.csv.gz",
    out parquet            cell_info_pq                  "Cell info parquet"        "cells.parquet",
    out path               cell_feature_matrix_mtx       "Cell-feature matrix in MEX format"  "cell_feature_matrix",
    out zarr.zip           cell_feature_matrix_zarr_zip  "Cell-feature matrix in zarr.zip format"  "cell_feature_matrix.zarr.zip",
    out h5                 cell_feature_matrix_h5        "Cell-feature matrix in h5 format"  "cell_feature_matrix.h5",
    out h5                 analysis_h5                   "Clustering result in h5 format"  "analysis.h5",
    out path               analysis_csv                  "Clustering result in csv format"  "analysis",
    out json               gene_summary,
    out zarr.zip           nucleus_distance,
    out bool               disable_create_gene_matrix,
    out bool               disable_analyzer,
)
{
    call COMPUTE_NUCLEAR_DISTANCE(
        mem_model_features = self.mem_model_features,
        transcripts        = self.transcripts,
        cells              = self.cell_segmentation_dataset,
        max_distance       = 50,
        method             = "simplified_poly",
    ) using (
        disabled = self.disable_create_gene_matrix,
    )

    call CREATE_GENE_MATRIX(
        mem_model_features = self.mem_model_features,
        transcripts        = self.transcripts,
        cells              = self.cell_segmentation_dataset,
        gene_panel         = self.gene_panel,
        min_q              = self.count_min_q,
        # Optional pre-computed results
        assignments        = self.pre_computed.transcript_assignments,
    ) using (
        disabled = self.disable_create_gene_matrix,
    )

    call CREATE_TRANSCRIPTS_CSV(
        mem_model_features     = self.mem_model_features,
        transcript_assignments = CREATE_GENE_MATRIX.transcript_assignments,
        cell_feature_matrix_h5 = CREATE_GENE_MATRIX.cell_feature_matrix_h5,
        transcripts            = self.transcripts,
        cells                  = self.cell_segmentation_dataset,
        nucleus_distance       = COMPUTE_NUCLEAR_DISTANCE.nucleus_distance,
    ) using (
        disabled = self.disable_create_gene_matrix,
    )

    call CONCATENATE_MATRIX(
        cell_gene_matrix_h5    = CREATE_GENE_MATRIX.cell_feature_matrix_h5,
        cell_protein_matrix_h5 = self.cell_protein_matrix_h5,
    )

    call CREATE_MATRIX_MTX(
        mem_model_features     = self.mem_model_features,
        cell_feature_matrix_h5 = CONCATENATE_MATRIX.cell_feature_matrix_h5,
    ) using (
        disabled = CONCATENATE_MATRIX.disable_analyzer,
    )

    call CREATE_MATRIX_ZARR(
        mem_model_features     = self.mem_model_features,
        cell_feature_matrix_h5 = CONCATENATE_MATRIX.cell_feature_matrix_h5,
    ) using (
        disabled = CONCATENATE_MATRIX.disable_analyzer,
    )

    call INSITU_ANALYZER(
        matrix_h5          = CONCATENATE_MATRIX.cell_feature_matrix_h5,
        disable_tsne       = self.disable_tsne,
        graphclust_threads = self.graphclust_threads,
    ) using (
        disabled = CONCATENATE_MATRIX.disable_analyzer,
    )

    call SELECT_ANALYZER_OUTS(
        analysis_h5  = INSITU_ANALYZER.analysis_h5,
        analysis_csv = INSITU_ANALYZER.analysis_csv,
        skipped      = INSITU_ANALYZER.skipped,
        disabled     = CONCATENATE_MATRIX.disable_analyzer,
    )

    return (
        cell_feature_matrix_mtx      = CREATE_MATRIX_MTX.cell_feature_matrix_mtx,
        cell_feature_matrix_h5       = CONCATENATE_MATRIX.cell_feature_matrix_h5,
        cell_feature_matrix_zarr_zip = CREATE_MATRIX_ZARR.cell_feature_matrix_zarr_zip,
        analysis_h5                  = SELECT_ANALYZER_OUTS.analysis_h5,
        analysis_csv                 = SELECT_ANALYZER_OUTS.analysis_csv,
        transcript_info_csv          = CREATE_TRANSCRIPTS_CSV.transcript_info_csv,
        transcript_info_pq           = CREATE_TRANSCRIPTS_CSV.transcript_info_pq,
        cell_info_csv                = CREATE_TRANSCRIPTS_CSV.cell_info_csv,
        cell_info_pq                 = CREATE_TRANSCRIPTS_CSV.cell_info_pq,
        gene_summary                 = CREATE_GENE_MATRIX.summary,
        nucleus_distance             = COMPUTE_NUCLEAR_DISTANCE.nucleus_distance,
        disable_create_gene_matrix   = self.disable_create_gene_matrix,
        disable_analyzer             = CONCATENATE_MATRIX.disable_analyzer,
    )
}

stage CONCATENATE_MATRIX(
    in  h5   cell_gene_matrix_h5,
    in  h5   cell_protein_matrix_h5,
    out h5   cell_feature_matrix_h5  "Cell-feature matrix in h5 format"  "cell_feature_matrix.h5",
    out bool disable_analyzer,
    src py   "./stages/concatenate_matrix",
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

stage COMPUTE_NUCLEAR_DISTANCE(
    in  json     mem_model_features,
    in  zarr.zip transcripts,
    in  zarr.zip cells,
    in  float    max_distance,
    in  str      method,
    out zarr.zip nucleus_distance,
    src py       "./stages/compute_nuclear_distance",
) split (
    in  int      mask_index,
    in  int      tile_x,
    in  int      tile_y,
    in  int      tile_dx,
    in  int      tile_dy,
    in  float    pixel_size,
    out zarr.zip distance_transform,
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

stage CREATE_GENE_MATRIX(
    in  json     mem_model_features,
    in  zarr.zip transcripts,
    in  zarr.zip cells,
    in  json     gene_panel,
    in  float    min_q,
    in  zarr     assignments             "optional pre-computed assignments",
    out h5       cell_feature_matrix_h5,
    out json     summary,
    out zarr     transcript_assignments,
    src py       "./stages/create_gene_matrix",
) split (
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
) retain (
    summary,
)

stage CREATE_MATRIX_MTX(
    in  json mem_model_features,
    in  h5   cell_feature_matrix_h5,
    out path cell_feature_matrix_mtx  "Cell-feature matrix in MEX format"  "cell_feature_matrix",
    src py   "./stages/create_matrix_mtx",
) split (
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

stage CREATE_MATRIX_ZARR(
    in  json     mem_model_features,
    in  h5       cell_feature_matrix_h5,
    out zarr.zip cell_feature_matrix_zarr_zip  "Cell-feature matrix in zarr.zip format"  "cell_feature_matrix.zarr.zip",
    src py       "./stages/create_matrix_zarr",
) split (
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

stage CREATE_TRANSCRIPTS_CSV(
    in  json     mem_model_features,
    in  zarr     transcript_assignments,
    in  h5       cell_feature_matrix_h5,
    in  zarr.zip transcripts,
    in  zarr.zip cells,
    in  zarr.zip nucleus_distance,
    out csv.gz   transcript_info_csv     "Transcript info CSV"      "transcripts.csv.gz",
    out parquet  transcript_info_pq      "Transcript info parquet"  "transcripts.parquet",
    out csv.gz   cell_info_csv           "Cell info CSV"            "cells.csv.gz",
    out parquet  cell_info_pq            "Cell info parquet"        "cells.parquet",
    src py       "./stages/create_transcripts_csv",
) split (
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

stage SELECT_ANALYZER_OUTS(
    in  h5   analysis_h5,
    in  path analysis_csv,
    in  bool skipped,
    in  bool disabled,
    out h5   analysis_h5   "Clustering result in h5 format"  "analysis.h5",
    out path analysis_csv  "Clustering result in csv format"  "analysis",
    src py   "./stages/select_analyzer_outs",
) using (
    vmem_gb = 16384,
)

#
# @include "_create_metrics_summary_csv_cs.mro"
#

stage CREATE_METRICS_SUMMARY_CSV_CS(
    in  json final_summary_json,
    out csv  metrics_summary,
    src py   "stages/create_metrics_summary_csv_cs",
) using (
    mem_gb   = 2,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "insitu/_xenium_ranger_common.mro"
#

stage XR_RELABEL_TRANSCRIPTS(
    in  json     mem_model_features,
    in  zarr.zip transcripts,
    in  json     original_gene_panel,
    in  json     gene_panel,
    out zarr.zip transcripts,
    src py       "stages/xr_relabel_transcripts",
) split (
) using (
    mem_gb   = 1,
    vmem_gb  = 16384,
    volatile = strict,
)

stage XR_SELECT_DATASET(
    in  zarr.zip      original,
    in  map<zarr.zip> choices,
    out zarr.zip      dataset,
    src py            "stages/xr_select_dataset",
) using (
    mem_gb   = 1,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "_format_outputs.mro"
#

stage FORMAT_OUTPUTS_CS(
    in  json      mem_model_features,
    in  html      web_summary,
    in  json      final_summary_json,
    in  json      gene_panel,
    in  json      sample_sheet,
    in  ome.tif   morphology,
    in  ome.tif   morphology_focus,
    in  ome.tif   morphology_mip,
    in  path      analysis_csv,
    in  zarr.zip  cell_feature_matrix_zarr_zip,
    in  zarr.zip  cell_segmentation,
    in  zarr.zip  transcripts,
    in  string    calibration_uuid,
    in  XrRunData xr_run_data,
    out zarr.zip  analysis_zarr_zip             "Clustering result in zarr.zip format"  "analysis.zarr.zip",
    out json      experiment_xenium             "Metadata for Xenium Explorer"  "experiment.xenium",
    src py        "stages/format_outputs_cs",
) split (
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "_make_output_manifest.mro"
#

stage MAKE_OUTPUT_MANIFEST(
    in  file[]     output_bundle_files,
    in  path[]     output_bundle_paths,
    in  file[]     telemetry_bundle_files,
    in  path[]     telemetry_bundle_paths,
    in  AuxOutputs aux_outputs,
    out json       output_manifest,
    src py         "stages/make_output_manifest",
) using (
    mem_gb   = 2,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "_websummary_stages_cs.mro"
#

stage CREATE_WEB_SUMMARY_CS(
    in  json                mem_model_features,
    in  string              sample_id,
    in  string              sample_desc,
    in  json[]              plot_details,
    in  json                final_summary_json,
    in  zarr.zip            transcripts,
    in  zarr.zip            cell_segmentation_dataset,
    in  h5                  analysis_h5,
    in  h5                  matrix,
    in  bool                is_add_on_panel,
    in  XeniumRangerPayload payload_files,
    in  XrRunData           xr_run_data,
    in  json                xr_table,
    out html                web_summary                "Customer-facing web summary"  "analysis_summary.html",
    out json                data,
    src py                  "stages/create_web_summary_cs",
) split (
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "_insitu_counter_cs.mro"
#

# Given CS transcripts and cells, perform the counting and metric calculation steps
# Produces a valid CS websummary and output bundle
pipeline INSITU_COUNTER_CS(
    in  zarr.zip           transcripts,
    in  zarr.zip           cells,
    in  json               gene_panel,
    in  ome.tif            morphology,
    in  ome.tif            morphology_mip,
    in  ome.tif            morphology_focus,
    in  str                calibration_uuid,
    in  json               mem_model_features,
    in  json               sample_sheet,
    in  json               fov_json,
    in  map<tiff>          per_cycle_channel_images,
    in  jpg                resized_overview_image,
    in  json               input_metrics_summary,
    in  json               pyramid_manifest,
    in  json               segmentation_plan,
    in  json[]             telemetry_bundle_files,
    in  path[]             telemetry_bundle_paths,
    in  PreComputedResults pre_computed,
    in  XrRunData          xr_run_data,
    in  json               xr_table,
    out OutputBundle       output_bundle,
    out json               output_manifest,
    out h5                 analysis_h5,
    out json               summary_cs,
    out json               plot_details,
)
{
    call SETUP_COUNTER_CS(
        mem_model_features = self.mem_model_features,
        gene_panel         = self.gene_panel,
        sample_sheet       = self.sample_sheet,
    )

    call WRITE_CELL_NUCLEI_BOUNDARIES_FILES(
        mem_model_features = self.mem_model_features,
        cells              = self.cells,
    )

    call INSITU_COUNTER_CORE(
        mem_model_features         = self.mem_model_features,
        transcripts                = self.transcripts,
        cell_segmentation_dataset  = self.cells,
        gene_panel                 = self.gene_panel,
        cell_protein_matrix_h5     = null,
        disable_tsne               = true,
        graphclust_threads         = 8,
        disable_create_gene_matrix = false,
        count_min_q                = 20,
        pre_computed               = self.pre_computed,
    )

    call METRIC_CALCULATOR_CS(
        mem_model_features     = self.mem_model_features,
        transcripts            = self.transcripts,
        cells                  = self.cells,
        matrix                 = INSITU_COUNTER_CORE.cell_feature_matrix_h5,
        gene_panel             = self.gene_panel,
        sample_sheet           = self.sample_sheet,
        morphology_image       = self.morphology_mip,
        input_metrics          = self.input_metrics_summary,
        is_add_on_panel        = SETUP_COUNTER_CS.is_add_on_panel,
        calibration_uuid       = self.calibration_uuid,
        resized_overview_image = self.resized_overview_image,
        xr_run_id              = self.xr_run_data.run_id,
    )

    call SIMPLE_MERGE_METRICS as MERGE_METRICS(
        summaries = [
            METRIC_CALCULATOR_CS.summary,
            INSITU_COUNTER_CORE.gene_summary,
        ],
    )

    call UPDATE_COUNT_METRICS(
        original_summary    = self.input_metrics_summary,
        new_metrics_summary = MERGE_METRICS.summary,
    )

    call CREATE_WEB_SUMMARY_CS(
        mem_model_features        = self.mem_model_features,
        sample_id                 = SETUP_COUNTER_CS.sample_id,
        sample_desc               = SETUP_COUNTER_CS.sample_desc,
        plot_details              = [METRIC_CALCULATOR_CS.details],
        final_summary_json        = UPDATE_COUNT_METRICS.updated_summary,
        transcripts               = self.transcripts,
        cell_segmentation_dataset = self.cells,
        analysis_h5               = INSITU_COUNTER_CORE.analysis_h5,
        matrix                    = INSITU_COUNTER_CORE.cell_feature_matrix_h5,
        is_add_on_panel           = SETUP_COUNTER_CS.is_add_on_panel,
        payload_files             = {
            fov_json:               self.fov_json,
            gene_panel:             self.gene_panel,
            mem_model_features:     self.mem_model_features,
            pyramid_manifest:       self.pyramid_manifest,
            resized_overview_image: self.resized_overview_image,
            sample_sheet:           self.sample_sheet,
            segmentation_plan:      self.segmentation_plan,
            summary_cs:             UPDATE_COUNT_METRICS.updated_summary,
            # xenium_ranger_table is calculated and overwritten at websummary creation time.
            xenium_ranger_table:    null,
        },
        xr_run_data               = self.xr_run_data,
        xr_table                  = self.xr_table,
    )

    call CREATE_METRICS_SUMMARY_CSV_CS(
        final_summary_json = UPDATE_COUNT_METRICS.updated_summary,
    )

    call FORMAT_OUTPUTS_CS(
        mem_model_features           = self.mem_model_features,
        sample_sheet                 = self.sample_sheet,
        analysis_csv                 = INSITU_COUNTER_CORE.analysis_csv,
        final_summary_json           = UPDATE_COUNT_METRICS.updated_summary,
        gene_panel                   = self.gene_panel,
        morphology                   = self.morphology,
        morphology_mip               = self.morphology_mip,
        morphology_focus             = self.morphology_focus,
        cell_segmentation            = self.cells,
        cell_feature_matrix_zarr_zip = INSITU_COUNTER_CORE.cell_feature_matrix_zarr_zip,
        transcripts                  = self.transcripts,
        web_summary                  = CREATE_WEB_SUMMARY_CS.web_summary,
        calibration_uuid             = self.calibration_uuid,
        xr_run_data                  = self.xr_run_data,
    )

    call MAKE_OUTPUT_MANIFEST(
        # we leave out gene_panel from output_bundle_files because currently it
        # seems it is being copied into the bundle directly from PA_SETUP in the
        # case of instrument runs
        # TODO(Peter) consider removing that and putting it here
        output_bundle_files    = [
            CREATE_METRICS_SUMMARY_CSV_CS.metrics_summary,
            self.transcripts,
            INSITU_COUNTER_CORE.transcript_info_csv,
            INSITU_COUNTER_CORE.transcript_info_pq,
            INSITU_COUNTER_CORE.cell_info_csv,
            INSITU_COUNTER_CORE.cell_info_pq,
            self.cells,
            WRITE_CELL_NUCLEI_BOUNDARIES_FILES.nucleus_boundaries_csv,
            WRITE_CELL_NUCLEI_BOUNDARIES_FILES.cell_boundaries_csv,
            WRITE_CELL_NUCLEI_BOUNDARIES_FILES.nucleus_boundaries_pq,
            WRITE_CELL_NUCLEI_BOUNDARIES_FILES.cell_boundaries_pq,
            FORMAT_OUTPUTS_CS.analysis_zarr_zip,
            INSITU_COUNTER_CORE.cell_feature_matrix_zarr_zip,
            INSITU_COUNTER_CORE.cell_feature_matrix_h5,
            self.morphology,
            self.morphology_mip,
            self.morphology_focus,
            FORMAT_OUTPUTS_CS.experiment_xenium,
            CREATE_WEB_SUMMARY_CS.web_summary,
        ],
        output_bundle_paths    = [
            INSITU_COUNTER_CORE.cell_feature_matrix_mtx,
            INSITU_COUNTER_CORE.analysis_csv,
        ],
        aux_outputs            = {
            fov_locations:            self.fov_json,
            per_cycle_channel_images: self.per_cycle_channel_images,
        },
        telemetry_bundle_files = self.telemetry_bundle_files,
        telemetry_bundle_paths = self.telemetry_bundle_paths,
    )

    return (
        output_bundle   = {
            analysis_csv:                 INSITU_COUNTER_CORE.analysis_csv,
            analysis_zarr_zip:            FORMAT_OUTPUTS_CS.analysis_zarr_zip,
            aux_outputs: {
                fov_locations:            self.fov_json,
                per_cycle_channel_images: self.per_cycle_channel_images,
            },
            cell_boundaries_csv:          WRITE_CELL_NUCLEI_BOUNDARIES_FILES.cell_boundaries_csv,
            cell_boundaries_pq:           WRITE_CELL_NUCLEI_BOUNDARIES_FILES.cell_boundaries_pq,
            cell_feature_matrix_h5:       INSITU_COUNTER_CORE.cell_feature_matrix_h5,
            cell_feature_matrix_mtx:      INSITU_COUNTER_CORE.cell_feature_matrix_mtx,
            cell_feature_matrix_zarr_zip: INSITU_COUNTER_CORE.cell_feature_matrix_zarr_zip,
            cell_info_csv:                INSITU_COUNTER_CORE.cell_info_csv,
            cell_info_pq:                 INSITU_COUNTER_CORE.cell_info_pq,
            cell_segmentation:            self.cells,
            experiment_xenium:            FORMAT_OUTPUTS_CS.experiment_xenium,
            gene_panel:                   self.gene_panel,
            metrics_summary:              CREATE_METRICS_SUMMARY_CSV_CS.metrics_summary,
            morphology:                   self.morphology,
            morphology_focus:             self.morphology_focus,
            morphology_mip:               self.morphology_mip,
            nucleus_boundaries_csv:       WRITE_CELL_NUCLEI_BOUNDARIES_FILES.nucleus_boundaries_csv,
            nucleus_boundaries_pq:        WRITE_CELL_NUCLEI_BOUNDARIES_FILES.nucleus_boundaries_pq,
            transcript_info_csv:          INSITU_COUNTER_CORE.transcript_info_csv,
            transcript_info_pq:           INSITU_COUNTER_CORE.transcript_info_pq,
            transcripts:                  self.transcripts,
            web_summary:                  CREATE_WEB_SUMMARY_CS.web_summary,
        },
        output_manifest = MAKE_OUTPUT_MANIFEST.output_manifest,
        analysis_h5     = INSITU_COUNTER_CORE.analysis_h5,
        summary_cs      = UPDATE_COUNT_METRICS.updated_summary,
        plot_details    = METRIC_CALCULATOR_CS.details,
    )
}

stage SETUP_COUNTER_CS(
    in  json   mem_model_features,
    in  json   gene_panel,
    in  json   sample_sheet,
    out bool   is_add_on_panel,
    out string sample_id,
    out string sample_desc,
    src py     "./stages/setup_counter_cs",
) split (
) using (
    mem_gb   = 4,
    vmem_gb  = 16384,
    volatile = strict,
)

stage UPDATE_COUNT_METRICS(
    in  json original_summary,
    in  json new_metrics_summary,
    out json updated_summary,
    src py   "stages/update_rerun_metrics",
) using (
    mem_gb   = 8,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "_point_cloud_registerer.mro"
#

# Subpipeline for performing three layers of registration:
#
# 1. Coarsely registering the decoding cycles against the localization cycle via
#    their DAPI channels.
# 2. Finely registering the decoding cycles against each other via point clouds,
#    using the coarse transforms as a starting point.
# 3. Registering the localization cycle against an arbitrary decoding cycle via
#    point cloud, so we can transform all the decoding cycles back into the
#    localization cycle's coordinates.

pipeline POINT_CLOUD_REGISTERER(
    in  DecodingPlan     decoding_plan,
    in  zarr.mzip        blob_dataset,
    in  zarr.zip         transform_dataset_in,
    in  bool             dev_reporting,
    out zarr.zip         transform_dataset_out,
    out StageStdOutput[] std_outputs,
    out map<json>        metrics,
    out int              registration_reference_bit,
)
{
    call SETUP_REGISTRATION(
        decoding_plan = self.decoding_plan,
    )

    call REGISTER_CYCLES_POINTS as REGISTER_DECODING_CYCLES_POINTS(
        decoding_plan        = self.decoding_plan,
        stage_name           = "Decoding",
        stage_label          = "decoding",
        blob_dataset         = self.blob_dataset,
        transform_dataset_in = self.transform_dataset_in,
        cycles_to_register   = SETUP_REGISTRATION.decoding_cycles,
        channels_to_register = SETUP_REGISTRATION.channels_for_decoding_cycles,
        reference_cycle      = SETUP_REGISTRATION.reference_cycle_for_decoding,
        reference_channel    = SETUP_REGISTRATION.reference_channel,
        dev_reporting        = self.dev_reporting,
    )

    call REGISTER_CYCLES_POINTS as REGISTER_LOCALIZATION_CYCLE_POINTS(
        decoding_plan        = self.decoding_plan,
        stage_name           = "Localization",
        stage_label          = "localization",
        blob_dataset         = self.blob_dataset,
        transform_dataset_in = self.transform_dataset_in,
        cycles_to_register   = SETUP_REGISTRATION.localization_cycle_and_registration_reference_cycle,
        channels_to_register = SETUP_REGISTRATION.channels_for_localization_cycle_and_registration_reference_cycle,
        reference_cycle      = SETUP_REGISTRATION.reference_cycle_for_localization,
        reference_channel    = SETUP_REGISTRATION.reference_channel,
        dev_reporting        = self.dev_reporting,
    ) using (
        disabled = SETUP_REGISTRATION.disable_localization_registration,
    )

    call FINALIZE_REGISTRATION(
        decoding_plan                = self.decoding_plan,
        decoding_pc_transforms       = REGISTER_DECODING_CYCLES_POINTS.transform_dataset_out,
        decoding_pc_cycles           = SETUP_REGISTRATION.decoding_cycles,
        decoding_pc_channels         = SETUP_REGISTRATION.channels_for_decoding_cycles,
        decoding_reference_cycle     = SETUP_REGISTRATION.reference_cycle_for_decoding,
        decoding_reference_channel   = SETUP_REGISTRATION.reference_channel,
        localization_pc_transforms   = REGISTER_LOCALIZATION_CYCLE_POINTS.transform_dataset_out,
        localization_pc_cycles       = SETUP_REGISTRATION.localization_cycle_and_registration_reference_cycle,
        localization_pc_channels     = SETUP_REGISTRATION.channels_for_localization_cycle_and_registration_reference_cycle,
        localization_reference_cycle = SETUP_REGISTRATION.reference_cycle_for_localization,
        localization_reference_channel = SETUP_REGISTRATION.reference_channel,
        transform_dataset_in         = self.transform_dataset_in,
    )

    return (
        transform_dataset_out      = FINALIZE_REGISTRATION.transform_dataset_out,
        std_outputs                = [
            REGISTER_DECODING_CYCLES_POINTS.std_output,
            REGISTER_LOCALIZATION_CYCLE_POINTS.std_output,
        ],
        metrics                    = {
            "REGISTER_DECODING_CYCLES_POINTS": REGISTER_DECODING_CYCLES_POINTS.std_output.metrics,
            "REGISTER_LOCALIZATION_CYCLE_POINTS": REGISTER_LOCALIZATION_CYCLE_POINTS.std_output.metrics,
        },
        registration_reference_bit = REGISTER_DECODING_CYCLES_POINTS.registration_reference_bit,
    )
}

stage SETUP_REGISTRATION(
    in  DecodingPlan decoding_plan,
    out int[]        decoding_cycles,
    out string[]     channels_for_decoding_cycles,
    out int          reference_cycle_for_decoding,
    out int[]        localization_cycle_and_registration_reference_cycle,
    out string[]     channels_for_localization_cycle_and_registration_reference_cycle,
    out int          reference_cycle_for_localization,
    out string       reference_channel,
    out string       channel_for_registration_reference_cycle,
    out bool         disable_localization_registration,
    src py           "stages/setup_registration",
) split (
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

stage REGISTER_CYCLES_DAPI(
    in  DecodingPlan             decoding_plan,
    in  int                      maximum_chunks,
    in  int                      min_batch_size,
    in  int                      localization_cycle,
    in  int[]                    decoding_cycles,
    out zarr.zip                 transform_dataset,
    out StageStdOutput           std_output,
    src py                       "stages/register_cycles_dapi",
) split (
    in  int                      cache_block_size,
    in  int                      cache_number_blocks,
    in  RegisterDAPIChunkInput[] chunk_input_list,
    out zarr.zip[]               chunk_transforms_list,
    out StageStdOutput[]         chunk_std_output_list,
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

stage REGISTER_CYCLES_POINTS(
    in  DecodingPlan   decoding_plan,
    in  string         stage_name,
    in  string         stage_label,
    in  int[]          cycles_to_register,
    in  string[]       channels_to_register,
    in  int            reference_cycle,
    in  string         reference_channel,
    in  zarr.mzip      blob_dataset,
    in  zarr.zip       transform_dataset_in,
    in  bool           dev_reporting,
    out zarr.zip       transform_dataset_out,
    out StageStdOutput std_output,
    out int            registration_reference_bit,
    src py             "stages/register_cycles_points",
) split (
    in  string         fov_name,
    out zarr.zip       chunk_output_transforms,
    out StageStdOutput chunk_std_output,
    out int            chunk_registration_reference_bit,
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

stage FINALIZE_REGISTRATION(
    in  DecodingPlan decoding_plan,
    in  zarr.zip     decoding_pc_transforms,
    in  int[]        decoding_pc_cycles,
    in  string[]     decoding_pc_channels,
    in  int          decoding_reference_cycle,
    in  string       decoding_reference_channel,
    in  zarr.zip     localization_pc_transforms,
    in  int[]        localization_pc_cycles,
    in  string[]     localization_pc_channels,
    in  int          localization_reference_cycle,
    in  string       localization_reference_channel,
    in  zarr.zip     transform_dataset_in,
    out zarr.zip     transform_dataset_out,
    src py           "stages/finalize_registration",
) split (
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "_rna_deduplicator.mro"
#

pipeline RNA_DEDUPLICATOR(
    in  DecodingPlan decoding_plan,
    in  zarr.mzip    rna_dataset_in,
    in  json         pyramid_manifest,
    in  int          maximum_chunks,
    out zarr.mzip    rna_dataset,
    out json         summary,
    out zarr.zip     rna_deduplication_summary,
    out png.zip      dx_figure_archive,
)
{
    call DEDUPLICATE_RNA as DEDUPLICATE_RNA_HV(
        decoding_plan            = self.decoding_plan,
        rna_dataset_in           = self.rna_dataset_in,
        pyramid_manifest         = self.pyramid_manifest,
        deduplication_summary_in = null,
        maximum_chunks           = self.maximum_chunks,
    )

    call DEDUPLICATE_RNA as DEDUPLICATE_RNA_DIAG(
        decoding_plan            = self.decoding_plan,
        rna_dataset_in           = self.rna_dataset_in,
        pyramid_manifest         = self.pyramid_manifest,
        deduplication_summary_in = DEDUPLICATE_RNA_HV.deduplication_summary_out,
        maximum_chunks           = self.maximum_chunks,
    )

    call FINALIZE_RNA_DEDUPLICATION(
        decoding_plan         = self.decoding_plan,
        rna_dataset_in        = self.rna_dataset_in,
        pyramid_manifest      = self.pyramid_manifest,
        deduplication_summary = DEDUPLICATE_RNA_DIAG.deduplication_summary_out,
        maximum_chunks        = self.maximum_chunks,
    )

    call GENERATE_RNA_DEDUPLICATION_PLOTS(
        decoding_plan         = self.decoding_plan,
        rna_dataset_before_deduplication = self.rna_dataset_in,
        rna_dataset_after_deduplication = FINALIZE_RNA_DEDUPLICATION.rna_dataset_out,
        deduplication_summary = DEDUPLICATE_RNA_DIAG.deduplication_summary_out,
        pyramid_manifest      = self.pyramid_manifest,
    )

    return (
        rna_dataset               = FINALIZE_RNA_DEDUPLICATION.rna_dataset_out,
        dx_figure_archive         = GENERATE_RNA_DEDUPLICATION_PLOTS.figure_archive,
        rna_deduplication_summary = DEDUPLICATE_RNA_DIAG.deduplication_summary_out,
        summary                   = GENERATE_RNA_DEDUPLICATION_PLOTS.metrics_summary,
    )
}

stage DEDUPLICATE_RNA(
    in  DecodingPlan        decoding_plan,
    in  zarr.mzip           rna_dataset_in,
    in  json                pyramid_manifest,
    in  int                 maximum_chunks,
    in  zarr.zip            deduplication_summary_in,
    out zarr.zip            deduplication_summary_out,
    src py                  "stages/deduplicate_rna",
) split (
    in  FoVPairChunkInput[] chunk_input_list,
    in  string[]            decoding_fovs,
    out DedupDebugStats[]   stats_list,
) using (
    mem_gb   = 8,
    vmem_gb  = 16384,
    volatile = strict,
)

stage FINALIZE_RNA_DEDUPLICATION(
    in  DecodingPlan decoding_plan,
    in  zarr.mzip    rna_dataset_in,
    in  zarr.zip     deduplication_summary,
    in  json         pyramid_manifest,
    in  int          maximum_chunks,
    out zarr.mzip    rna_dataset_out,
    src py           "stages/finalize_rna_deduplication",
) split (
    in  string[]     fov_names,
    in  string[]     decoding_fovs,
    out path         rna_dataset_per_fov,
) using (
    mem_gb   = 8,
    vmem_gb  = 16384,
    volatile = strict,
)

stage GENERATE_RNA_DEDUPLICATION_PLOTS(
    in  DecodingPlan decoding_plan,
    in  zarr.mzip    rna_dataset_before_deduplication,
    in  zarr.mzip    rna_dataset_after_deduplication,
    in  zarr.zip     deduplication_summary,
    in  json         pyramid_manifest,
    out json         metrics_summary,
    out png.zip      figure_archive,
    src py           "stages/metrics/generate_rna_deduplication_plots",
) split (
    in  string       orientation,
) using (
    mem_gb   = 8,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "_store_rna_dataset.mro"
#

stage STORE_RNA_DATASET_CS(
    in  DecodingPlan decoding_plan,
    in  zarr.mzip    rna_dataset,
    out zarr.zip     transcripts,
    src py           "stages/store_rna_dataset_cs",
) split (
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "_websummary_stages_dx.mro"
#

# NOTE: preserve any intermediate inputs into this stage by passing to the
# top-level outputs of PA_FINALIZE
# NOTE: be careful about reorganizing inputs/outputs to make it easier to
# maintain backwards compatibility
stage CREATE_WEB_SUMMARY_DX(
    in  DecodingPlan     decoding_plan,
    in  json[]           plot_details,
    in  json             final_summary_json,
    in  zarr.zip         cell_segmentation_dataset,
    in  h5               analysis_h5,
    in  h5               matrix,
    in  StageStdOutput[] registration_results,
    in  zarr.zip         decoding_diagnostics_dataset,
    in  path             spatial_plots,
    in  zarr.mzip        stitching_summary,
    in  png.zip          deduplication_figure_archive,
    in  npz              fit_status_xyz,
    # ----
    out html             web_summary                   "Diagnostic web summary"  "diagnostics.html",
    out json             data,
    out csv              debug_metrics,
    src py               "stages/create_web_summary_dx",
) split (
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

#
# @include "insitu/pa_finalize.mro"
#

# Complete primary analsyis given the analysis results from a series of scans.
pipeline PA_FINALIZE(
    in  string                           sample_id,
    in  DecodingPlan                     setup_decoding_plan,
    in  zarr.mzip[]                      blob_dataset_list,
    in  zarr.mzip[]                      imaging_dx_dataset_list,
    in  zarr.zip[]                       transform_dataset_list,
    in  zarr.zip[]                       z_bounds_dataset_list,
    in  json[]                           blob_dataset_metrics_list,
    in  MorphologyPyramidBuilderOutput[] morpho_builder_out_list,
    in  SegOutput[]                      seg_out_list,
    in  json                             pa_setup_metadata,
    in  json                             gene_panel,
    in  png                              overview_nuv_image,
    out json                             output_manifest,
    out zarr.mzip                        blob_dataset,
    out zarr.mzip                        rna_dataset,
    out zarr.mzip                        duplicated_rna_dataset,
    out zarr.mzip                        imaging_dx_dataset,
    out zarr.zip                         transform_dataset,
    out zarr.zip                         z_bounds_dataset,
    out zarr.zip                         transcripts,
    out csv.gz                           transcript_info_csv           "Transcript info CSV"       "transcripts.csv.gz",
    out parquet                          transcript_info_pq            "Transcript info parquet"   "transcripts.parquet",
    out csv.gz                           cell_info_csv                 "Cell info CSV"             "cells.csv.gz",
    out parquet                          cell_info_pq                  "Cell info parquet"         "cells.parquet",
    out zarr.zip                         cell_segmentation             "Cell segmentation result"  "cells.zarr.zip",
    out csv.gz                           cell_boundaries_csv           "Cell segmentation cell polygons CSV"  "cell_boundaries.csv.gz",
    out csv.gz                           nucleus_boundaries_csv        "Cell segmentation nucleus polygons CSV"  "nucleus_boundaries.csv.gz",
    out parquet                          cell_boundaries_pq            "Cell segmentation cell polygons parquet"  "cell_boundaries.parquet",
    out parquet                          nucleus_boundaries_pq         "Cell segmentation nucleus polygons parquet"  "nucleus_boundaries.parquet",
    out path                             cell_feature_matrix_mtx       "Cell-feature matrix in MEX format"  "cell_feature_matrix",
    out zarr.zip                         cell_feature_matrix_zarr_zip  "Cell-feature matrix in zarr.zip format"  "cell_feature_matrix.zarr.zip",
    out h5                               cell_feature_matrix_h5        "Cell-feature matrix in h5 format"  "cell_feature_matrix.h5",
    out zarr.mzip                        stitching_summary,
    out csv                              metrics_summary,
    out ome.tif                          morphology                    "CS OME-TIFF (ZSTACK)"      "morphology.ome.tif",
    out ome.tif                          morphology_mip                "CS OME-TIFF (MIP)"         "morphology_mip.ome.tif",
    out ome.tif                          morphology_focus              "CS OME-TIFF (AUTOFOCUS)"   "morphology_focus.ome.tif",
    out json                             pyramid_manifest              "CS image pyramid manifest"  "morphology.tenx.json",
    out zarr.zip                         rna_deduplication_summary,
    out h5                               analysis_h5,
    out path                             analysis_csv                  "Clustering result in csv format"  "analysis",
    out zarr.zip                         analysis_zarr_zip             "Clustering result in zarr.zip format"  "analysis.zarr.zip",
    out json                             summary_metrics               "Summary metrics JSON"      "summary.json",
    out json                             summary_metrics_cs            "CS Summary metrics JSON"   "summary_cs.json",
    out json                             per_fov_metrics,
    out csv                              debug_metrics                 "A short list of metrics to evaluate IPT outcome",
    out AuxOutputs                       aux_outputs                   "Auxiliary output files",
    out json                             experiment_xenium             "Metadata for Xenium Explorer"  "experiment.xenium",
    out html                             web_summary                   "Customer-facing web summary"  "analysis_summary.html",
    out DiagnosticsOutput                diagnostics,
    out json[]                           plot_details,
    out StageStdOutput[]                 registration_results,
    out path                             spatial_plots,
    out png.zip                          deduplication_figure_archive,
)
{
    call PA_FINALIZE_PREFLIGHT(
        sample_id                 = self.sample_id,
        setup_decoding_plan       = self.setup_decoding_plan,
        blob_dataset_list         = self.blob_dataset_list,
        transform_dataset_list    = self.transform_dataset_list,
        blob_dataset_metrics_list = self.blob_dataset_metrics_list,
        morpho_builder_out_list   = self.morpho_builder_out_list,
        pa_setup_metadata         = self.pa_setup_metadata,
        gene_panel                = self.gene_panel,
    ) using (
        preflight = true,
    )

    call AGGREGATE_SCAN_DATA(
        setup_decoding_plan       = self.setup_decoding_plan,
        blob_dataset_list         = self.blob_dataset_list,
        blob_dataset_metrics_list = self.blob_dataset_metrics_list,
        transform_dataset_list    = self.transform_dataset_list,
        z_bounds_dataset_list     = self.z_bounds_dataset_list,
        morpho_builder_out_list   = self.morpho_builder_out_list,
        seg_out_list              = self.seg_out_list,
        pa_setup_metadata         = self.pa_setup_metadata,
    )

    call POINT_CLOUD_REGISTERER(
        decoding_plan        = AGGREGATE_SCAN_DATA.decoding_plan,
        blob_dataset         = AGGREGATE_SCAN_DATA.blob_dataset,
        transform_dataset_in = AGGREGATE_SCAN_DATA.transform_dataset,
        dev_reporting        = true,
    )

    call FINE_TUNE_REGISTRATION(
        decoding_plan              = AGGREGATE_SCAN_DATA.decoding_plan,
        blob_dataset               = AGGREGATE_SCAN_DATA.blob_dataset,
        transform_dataset          = POINT_CLOUD_REGISTERER.transform_dataset_out,
        blob_dataset_metrics       = AGGREGATE_SCAN_DATA.blob_dataset_metrics,
        dev_reporting              = false,
        registration_reference_bit = POINT_CLOUD_REGISTERER.registration_reference_bit,
    )

    call BUILD_DECODING_MODEL(
        decoding_plan     = AGGREGATE_SCAN_DATA.decoding_plan,
        blob_dataset      = AGGREGATE_SCAN_DATA.blob_dataset,
        transform_dataset = FINE_TUNE_REGISTRATION.fine_tuned_transform_dataset,
    )

    call DECODE_POINTS(
        decoding_plan     = AGGREGATE_SCAN_DATA.decoding_plan,
        blob_dataset      = AGGREGATE_SCAN_DATA.blob_dataset,
        transform_dataset = FINE_TUNE_REGISTRATION.fine_tuned_transform_dataset,
        analog_model      = BUILD_DECODING_MODEL.analog_model,
    )

    call RNA_DEDUPLICATOR(
        decoding_plan    = AGGREGATE_SCAN_DATA.decoding_plan,
        rna_dataset_in   = DECODE_POINTS.rna_dataset,
        maximum_chunks   = 30,
        pyramid_manifest = AGGREGATE_SCAN_DATA.morpho_builder_out.pyramid_manifest,
    )

    call STORE_RNA_DATASET_CS(
        decoding_plan = self.setup_decoding_plan,
        rna_dataset   = RNA_DEDUPLICATOR.rna_dataset,
    )

    call AGGREGATE_METRICS(
        decoding_plan               = AGGREGATE_SCAN_DATA.decoding_plan,
        aggregated_summaries        = [
            AGGREGATE_SCAN_DATA.seg_output.cell_seg_summary,
            DECODE_POINTS.summary,
            AGGREGATE_SCAN_DATA.morpho_builder_out.estimate_fov_pos_summary,
            AGGREGATE_SCAN_DATA.morpho_builder_out.make_morphology_pyramid_summary,
            RNA_DEDUPLICATOR.summary,
        ],
        codeword_metrics            = null,
        input_metric_file_lists     = [
            {
                "AGGREGATE_SCAN_DATA": AGGREGATE_SCAN_DATA.seg_output.cell_seg_summary,
                "BLOB_FINDER": AGGREGATE_SCAN_DATA.blob_dataset_metrics,
                "DECODE_POINTS": DECODE_POINTS.summary,
                "FINE_TUNE_REGISTRATION": FINE_TUNE_REGISTRATION.stage_bag.metrics,
                "INSITU_COUNTER": null,
                "METRIC_CALCULATOR_CS": null,
            },
            POINT_CLOUD_REGISTERER.metrics,
        ],
        input_fov_metric_file_lists = [
            {
                "METRIC_CALCULATOR_DX": null,
            },
        ],
        pa_setup_metadata           = self.pa_setup_metadata,
        brightness_by_gene          = null,
    )

    call CREATE_PER_BIT_FLUOR_IMAGES(
        decoding_plan           = AGGREGATE_SCAN_DATA.decoding_plan,
        pyramid_manifest        = AGGREGATE_SCAN_DATA.morpho_builder_out.pyramid_manifest,
        imaging_dx_dataset_list = self.imaging_dx_dataset_list,
        transform_dataset       = FINE_TUNE_REGISTRATION.fine_tuned_transform_dataset,
    )

    call CREATE_AUX_OUTPUTS_CS(
        decoding_plan      = AGGREGATE_SCAN_DATA.decoding_plan,
        pyramid_manifest   = AGGREGATE_SCAN_DATA.morpho_builder_out.pyramid_manifest,
        overview_nuv_image = self.overview_nuv_image,
    )

    call PLAN_SEGMENTATION(
        decoding_plan  = AGGREGATE_SCAN_DATA.decoding_plan,
        seg_input_list = [AGGREGATE_SCAN_DATA.morpho_builder_out],
        cycle_ix       = -1,
    )

    call INSITU_COUNTER_CS(
        transcripts              = STORE_RNA_DATASET_CS.transcripts,
        cells                    = AGGREGATE_SCAN_DATA.seg_output.cell_segmentation_dataset,
        gene_panel               = self.gene_panel,
        morphology               = AGGREGATE_SCAN_DATA.morpho_builder_out.morphology,
        morphology_mip           = AGGREGATE_SCAN_DATA.morpho_builder_out.morphology_mip,
        morphology_focus         = AGGREGATE_SCAN_DATA.morpho_builder_out.morphology_focus,
        calibration_uuid         = CREATE_AUX_OUTPUTS_CS.calibration_uuid,
        mem_model_features       = AGGREGATE_SCAN_DATA.decoding_plan.mem_model_features,
        sample_sheet             = AGGREGATE_SCAN_DATA.sample_sheet,
        fov_json                 = CREATE_AUX_OUTPUTS_CS.fov_json,
        per_cycle_channel_images = CREATE_PER_BIT_FLUOR_IMAGES.per_cycle_channel_images,
        resized_overview_image   = CREATE_AUX_OUTPUTS_CS.resized_overview_image,
        input_metrics_summary    = AGGREGATE_METRICS.summary_cs,
        pyramid_manifest         = AGGREGATE_SCAN_DATA.morpho_builder_out.pyramid_manifest,
        segmentation_plan        = PLAN_SEGMENTATION.segmentation_plan,
        telemetry_bundle_files   = [
            AGGREGATE_METRICS.summary,
            AGGREGATE_METRICS.per_fov_metrics,
        ],
        telemetry_bundle_paths   = [],
        pre_computed             = null,
        xr_run_data              = null,
        xr_table                 = null,
    )

    call METRIC_CALCULATOR_DX(
        decoding_plan             = AGGREGATE_SCAN_DATA.decoding_plan,
        rna_dataset_with_dups     = DECODE_POINTS.rna_dataset,
        rna_dataset_without_dups  = RNA_DEDUPLICATOR.rna_dataset,
        blob_dataset              = AGGREGATE_SCAN_DATA.blob_dataset,
        transform_dataset         = FINE_TUNE_REGISTRATION.fine_tuned_transform_dataset,
        z_bounds_dataset          = AGGREGATE_SCAN_DATA.z_bounds_dataset,
        cell_segmentation_dataset = AGGREGATE_SCAN_DATA.seg_output.cell_segmentation_dataset,
        pyramid_manifest          = AGGREGATE_SCAN_DATA.morpho_builder_out.pyramid_manifest,
        analysis_csv              = INSITU_COUNTER_CS.output_bundle.analysis_csv,
        morpho_pyramid_summary    = AGGREGATE_SCAN_DATA.morpho_builder_out.make_morphology_pyramid_summary,
        is_pd                     = false,
        transcript_info_csv       = INSITU_COUNTER_CS.output_bundle.transcript_info_csv,
        matrix_h5                 = INSITU_COUNTER_CS.output_bundle.cell_feature_matrix_h5,
    )

    call SIMPLE_MERGE_METRICS as MERGE_FINAL_METRICS(
        summaries = [
            METRIC_CALCULATOR_DX.summary,
            INSITU_COUNTER_CS.summary_cs,
            AGGREGATE_METRICS.summary,
            CREATE_PER_BIT_FLUOR_IMAGES.summary,
        ],
    )

    call CREATE_WEB_SUMMARY_DX(
        decoding_plan                = AGGREGATE_SCAN_DATA.decoding_plan,
        plot_details                 = [
            INSITU_COUNTER_CS.plot_details,
            METRIC_CALCULATOR_DX.roll_off_details,
            METRIC_CALCULATOR_DX.codeword_plot_details,
        ],
        final_summary_json           = MERGE_FINAL_METRICS.summary,
        cell_segmentation_dataset    = AGGREGATE_SCAN_DATA.seg_output.cell_segmentation_dataset,
        analysis_h5                  = INSITU_COUNTER_CS.analysis_h5,
        matrix                       = INSITU_COUNTER_CS.output_bundle.cell_feature_matrix_h5,
        decoding_diagnostics_dataset = METRIC_CALCULATOR_DX.decoding_diagnostics_dataset,
        registration_results         = POINT_CLOUD_REGISTERER.std_outputs,
        spatial_plots                = METRIC_CALCULATOR_DX.spatial_plots,
        stitching_summary            = AGGREGATE_SCAN_DATA.morpho_builder_out.stitching_summary,
        deduplication_figure_archive = RNA_DEDUPLICATOR.dx_figure_archive,
        fit_status_xyz               = null,
    )

    return (
        # DX/PD outputs (not in output bundle)
        analysis_h5                  = INSITU_COUNTER_CS.analysis_h5,
        blob_dataset                 = AGGREGATE_SCAN_DATA.blob_dataset,
        imaging_dx_dataset           = CREATE_PER_BIT_FLUOR_IMAGES.imaging_dx_dataset,
        debug_metrics                = CREATE_WEB_SUMMARY_DX.debug_metrics,
        deduplication_figure_archive = RNA_DEDUPLICATOR.dx_figure_archive,
        diagnostics                  = {
            decoding_diagnostics_dataset: METRIC_CALCULATOR_DX.decoding_diagnostics_dataset,
            web_summary:                  CREATE_WEB_SUMMARY_DX.web_summary,
        },
        duplicated_rna_dataset       = DECODE_POINTS.rna_dataset,
        per_fov_metrics              = AGGREGATE_METRICS.per_fov_metrics,
        output_manifest              = INSITU_COUNTER_CS.output_manifest,
        plot_details                 = [METRIC_CALCULATOR_DX.roll_off_details],
        pyramid_manifest             = AGGREGATE_SCAN_DATA.morpho_builder_out.pyramid_manifest,
        registration_results         = POINT_CLOUD_REGISTERER.std_outputs,
        rna_dataset                  = RNA_DEDUPLICATOR.rna_dataset,
        rna_deduplication_summary    = RNA_DEDUPLICATOR.rna_deduplication_summary,
        spatial_plots                = METRIC_CALCULATOR_DX.spatial_plots,
        stitching_summary            = AGGREGATE_SCAN_DATA.morpho_builder_out.stitching_summary,
        summary_metrics              = MERGE_FINAL_METRICS.summary,
        summary_metrics_cs           = INSITU_COUNTER_CS.summary_cs,
        transform_dataset            = FINE_TUNE_REGISTRATION.fine_tuned_transform_dataset,
        z_bounds_dataset             = AGGREGATE_SCAN_DATA.z_bounds_dataset,
        # CS outputs (in output bundle)
        *                            = INSITU_COUNTER_CS.output_bundle,
    )
}

stage PA_FINALIZE_PREFLIGHT(
    in  string                           sample_id,
    in  DecodingPlan                     setup_decoding_plan,
    in  zarr.mzip[]                      blob_dataset_list,
    in  zarr.zip[]                       transform_dataset_list,
    in  json[]                           blob_dataset_metrics_list,
    in  MorphologyPyramidBuilderOutput[] morpho_builder_out_list,
    in  json                             pa_setup_metadata,
    in  json                             gene_panel,
    src py                               "stages/pa_finalize_preflight",
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

stage AGGREGATE_SCAN_DATA(
    in  DecodingPlan                     setup_decoding_plan,
    in  zarr.mzip[]                      blob_dataset_list,
    in  json[]                           blob_dataset_metrics_list,
    in  zarr.zip[]                       transform_dataset_list,
    in  zarr.zip[]                       z_bounds_dataset_list,
    in  MorphologyPyramidBuilderOutput[] morpho_builder_out_list,
    in  SegOutput[]                      seg_out_list,
    in  json                             pa_setup_metadata,
    out zarr.mzip                        blob_dataset,
    out json                             blob_dataset_metrics,
    out zarr.zip                         transform_dataset,
    out zarr.zip                         z_bounds_dataset,
    out DecodingPlan                     decoding_plan,
    out MorphologyPyramidBuilderOutput   morpho_builder_out,
    out SegOutput                        seg_output,
    out json                             sample_sheet,
    src py                               "stages/pa_aggregate_scan_data",
) split (
) using (
    mem_gb   = 16,
    vmem_gb  = 16384,
    volatile = strict,
)

# Compute stitched low-res fluorescent images & any imaging dx dataset metrics
stage CREATE_PER_BIT_FLUOR_IMAGES(
    in  DecodingPlan decoding_plan,
    in  json         pyramid_manifest,
    in  zarr.mzip[]  imaging_dx_dataset_list,
    in  zarr.zip     transform_dataset,
    out map<tiff>    per_cycle_channel_images,
    # concatenated dataset or null if already in one piece
    out zarr.mzip    imaging_dx_dataset,
    out json         summary,
    src py           "stages/create_per_bit_fluor_images",
) split (
    in  zarr.mzip    imaging_dx_dataset,
) using (
    volatile = strict,
)

#
# @include "/scratch/nightly/runs/2023_08_10/2023.0810-2x2_FoV_Mouse_Brain_Finalize/scratch/invoke_pa_finalize.mro"
#

call PA_FINALIZE(
    sample_id                 = "1de1c03e-5b80-41f6-bf50-6e37b24df4c0",
    setup_decoding_plan       = {
        decoding_input:     "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/setup/outs/decoding_plan/decoding_input.json",
        external_locations: "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/setup/outs/decoding_plan/external_locations.json",
        imaging_manifest:   "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/setup/outs/decoding_plan/imaging_manifest.zarr.zip",
        mem_model_features: "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/setup/outs/decoding_plan/mem_model_features.json",
    },
    blob_dataset_list         = [
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-0/outs/blob_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-1/outs/blob_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-10/outs/blob_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-11/outs/blob_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-12/outs/blob_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-13/outs/blob_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-14/outs/blob_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-2/outs/blob_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-3/outs/blob_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-4/outs/blob_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-5/outs/blob_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-6/outs/blob_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-7/outs/blob_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-8/outs/blob_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-9/outs/blob_dataset.zarr.mzip",
    ],
    imaging_dx_dataset_list   = [
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-0/outs/imaging_dx_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-1/outs/imaging_dx_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-10/outs/imaging_dx_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-11/outs/imaging_dx_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-12/outs/imaging_dx_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-13/outs/imaging_dx_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-14/outs/imaging_dx_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-2/outs/imaging_dx_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-3/outs/imaging_dx_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-4/outs/imaging_dx_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-5/outs/imaging_dx_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-6/outs/imaging_dx_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-7/outs/imaging_dx_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-8/outs/imaging_dx_dataset.zarr.mzip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-9/outs/imaging_dx_dataset.zarr.mzip",
    ],
    transform_dataset_list    = [
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-0/outs/transform_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-1/outs/transform_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-10/outs/transform_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-11/outs/transform_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-12/outs/transform_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-13/outs/transform_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-14/outs/transform_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-2/outs/transform_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-3/outs/transform_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-4/outs/transform_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-5/outs/transform_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-6/outs/transform_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-7/outs/transform_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-8/outs/transform_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-9/outs/transform_dataset.zarr.zip",
    ],
    z_bounds_dataset_list     = [
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-0/outs/z_bounds_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-1/outs/z_bounds_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-10/outs/z_bounds_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-11/outs/z_bounds_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-12/outs/z_bounds_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-13/outs/z_bounds_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-14/outs/z_bounds_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-2/outs/z_bounds_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-3/outs/z_bounds_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-4/outs/z_bounds_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-5/outs/z_bounds_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-6/outs/z_bounds_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-7/outs/z_bounds_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-8/outs/z_bounds_dataset.zarr.zip",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-9/outs/z_bounds_dataset.zarr.zip",
    ],
    blob_dataset_metrics_list = [
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-0/outs/blob_dataset_metrics.json",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-1/outs/blob_dataset_metrics.json",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-10/outs/blob_dataset_metrics.json",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-11/outs/blob_dataset_metrics.json",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-12/outs/blob_dataset_metrics.json",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-13/outs/blob_dataset_metrics.json",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-14/outs/blob_dataset_metrics.json",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-2/outs/blob_dataset_metrics.json",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-3/outs/blob_dataset_metrics.json",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-4/outs/blob_dataset_metrics.json",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-5/outs/blob_dataset_metrics.json",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-6/outs/blob_dataset_metrics.json",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-7/outs/blob_dataset_metrics.json",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-8/outs/blob_dataset_metrics.json",
        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-9/outs/blob_dataset_metrics.json",
    ],
    morpho_builder_out_list   = [
        {
            estimate_fov_pos_summary:        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-0/outs/morpho_builder_out/estimate_fov_pos_summary.json",
            make_morphology_pyramid_summary: "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-0/outs/morpho_builder_out/make_morphology_pyramid_summary.json",
            morpho_transform_dataset:        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-0/outs/morpho_builder_out/morpho_transform_dataset.zarr.zip",
            morphology:                      "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-0/outs/morpho_builder_out/morphology.ome.tif",
            morphology_focus:                "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-0/outs/morpho_builder_out/morphology_focus.ome.tif",
            morphology_mip:                  "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-0/outs/morpho_builder_out/morphology_mip.ome.tif",
            pyramid_manifest:                "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-0/outs/morpho_builder_out/pyramid_manifest.json",
            stitching_summary:               "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/process_cycle-cycle-0/outs/morpho_builder_out/stitching_summary.zarr.mzip",
        },
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
    ],
    seg_out_list              = [
        null,
        null,
        null,
        null,
        null,
        {
            cell_boundaries_csv:       "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/segment_finalize-cycle-13/outs/seg_output/cell_boundaries.csv.gz",
            cell_boundaries_pq:        "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/segment_finalize-cycle-13/outs/seg_output/cell_boundaries.parquet",
            cell_seg_summary:          "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/segment_finalize-cycle-13/outs/seg_output/cell_seg_summary.json",
            cell_segmentation_dataset: "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/segment_finalize-cycle-13/outs/seg_output/cell_segmentation_dataset.zarr.zip",
            nucleus_boundaries_csv:    "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/segment_finalize-cycle-13/outs/seg_output/nucleus_boundaries.csv.gz",
            nucleus_boundaries_pq:     "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/segment_finalize-cycle-13/outs/seg_output/nucleus_boundaries.parquet",
        },
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
    ],
    pa_setup_metadata         = "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/setup/outs/pa_setup_metadata.json",
    gene_panel                = "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/setup/outs/gene_panel.json",
    overview_nuv_image        = "/scratch/nightly/rerun_datasets/test_data_cs1_a0014_cs1874_mbrain_addon_2x2/complete/success/setup/outs/overview_nuv_image.png",
)

--------------------------------------------------------------------------------

(source_file
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (identifier))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (filetype_declaration
    filetype: (id_list
      (identifier)
      (identifier)))
  (comment)
  (comment)
  (comment)
  (filetype_declaration
    filetype: (identifier))
  (comment)
  (comment)
  (comment)
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))))
  (comment)
  (struct_declaration
    name: (identifier)
    (comment)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (comment)
      (comment)
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (comment)
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (comment)
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (comment)
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (comment)
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))))
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))))
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))))
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))))
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))))
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))))
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))))
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))))
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))))
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))))
  (comment)
  (comment)
  (comment)
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))))
  (comment)
  (comment)
  (comment)
  (comment)
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))))
  (comment)
  (comment)
  (comment)
  (comment)
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))))
  (comment)
  (comment)
  (comment)
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))))
  (comment)
  (comment)
  (comment)
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))))
  (comment)
  (comment)
  (struct_declaration
    name: (identifier)
    (comment)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (comment)
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (comment)
      (comment)
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (comment)
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (comment)
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (comment)
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (comment)
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))))
  (comment)
  (struct_declaration
    name: (identifier)
    (comment)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))))
  (comment)
  (struct_declaration
    name: (identifier)
    (comment)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string))
      (comment)
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string))
      (comment)
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string))))
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))))
  (comment)
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (map_type
            (parameter_type
              (identifier))))
        name: (identifier))))
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string))))
  (comment)
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string))
      (struct_field
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string))))
  (comment)
  (comment)
  (comment)
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))))
  (comment)
  (comment)
  (comment)
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))))
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (primitive_type))
        name: (identifier))))
  (struct_declaration
    name: (identifier)
    body: (struct_field_list
      (struct_field
        type: (parameter_type
          (array_type
            (parameter_type
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (array_type
            (parameter_type
              (identifier))))
        name: (identifier))
      (struct_field
        type: (parameter_type
          (array_type
            (parameter_type
              (identifier))))
        name: (identifier))))
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (pipeline_declaration
    name: (identifier)
    parameters: (parameter_list
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (in_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (comment)
    (comment)
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (call_alias
        alias: (identifier))
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier))))))))))
    (call_stm
      name: (identifier)
      (call_alias
        alias: (identifier))
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier))))))))))
    (return_stm
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)))))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier))))))
    (retain_list
      name: (ref_exp
        (identifier))))
  (comment)
  (comment)
  (comment)
  (pipeline_declaration
    name: (identifier)
    parameters: (parameter_list
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (in_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (out_param
        type: (parameter_type
          (primitive_type))
        name: (identifier)))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (comment)
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (comment)
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (false)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (call_alias
        alias: (identifier))
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier))))))))))
    (return_stm
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)))))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (comment)
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (comment)
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (comment)
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (array_type
                  (parameter_type
                    (identifier))))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)
          help: (string)
          output_name: (string))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)
          help: (string)
          output_name: (string))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)
          help: (string)
          output_name: (string))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)
          help: (string)
          output_name: (string))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)
          help: (string)
          output_name: (string)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)
          help: (string)
          output_name: (string))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)
          help: (string)
          output_name: (string))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)
          help: (string)
          output_name: (string))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)
          help: (string)
          output_name: (string)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (pipeline_declaration
    name: (identifier)
    parameters: (parameter_list
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (array_type
            (parameter_type
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (out_param
        type: (parameter_type
          (array_type
            (parameter_type
              (identifier))))
        name: (identifier)))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier))))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (true))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)))))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (id_list
                    (identifier)
                    (identifier)))))))))
    (return_stm
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)))))))))
  (pipeline_declaration
    name: (identifier)
    parameters: (parameter_list
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (array_type
            (parameter_type
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (array_type
            (parameter_type
              (array_type
                (parameter_type
                  (identifier))))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier))))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (true))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier))))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (id_list
                    (identifier)
                    (identifier)))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier)))))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (id_list
                    (identifier)
                    (identifier)))))))))
    (return_stm
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (map_exp
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))))))))
  (pipeline_declaration
    name: (identifier)
    parameters: (parameter_list
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (ref_exp
                  (ref_list
                    (identifier)))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (integer)))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (comment)
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))))
    (return_stm
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (map_exp
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (array_type
                  (parameter_type
                    (identifier))))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (comment)
        (comment)
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (comment)
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (map_type
                  (parameter_type
                    (identifier))))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (map_type
                  (parameter_type
                    (identifier))))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier))))))
    (retain_list
      name: (ref_exp
        (identifier))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier))))))
    (retain_list
      name: (ref_exp
        (identifier))))
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (map_type))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (map_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (pipeline_declaration
    name: (identifier)
    parameters: (parameter_list
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (in_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (primitive_type))
        name: (identifier)))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (call_alias
        alias: (identifier))
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (false))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (id_list
                    (identifier)
                    (identifier))))))
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (true))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (id_list
                    (identifier)
                    (identifier))))))
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (true))))))
    (call_stm
      name: (identifier)
      (call_alias
        alias: (identifier))
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (false)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (true))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (id_list
                    (identifier)
                    (identifier))))))
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (true))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)))))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (id_list
                    (identifier)
                    (identifier))))))
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (true))))))
    (call_stm
      name: (identifier)
      (call_alias
        alias: (identifier))
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (false))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (id_list
                    (identifier)
                    (identifier))))))
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (true))))))
    (call_stm
      name: (identifier)
      (call_alias
        alias: (identifier))
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (false))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (id_list
                    (identifier)
                    (identifier))))))
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (true))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (false)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (string))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (id_list
                    (identifier)
                    (identifier))))))
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (true))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)))))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (id_list
                    (identifier)
                    (identifier)))))))))
    (return_stm
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)))))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)
          help: (string)
          output_name: (string))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)
          help: (string)
          output_name: (string)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (comment)
  (pipeline_declaration
    name: (identifier)
    parameters: (parameter_list
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (in_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (in_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (in_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (comment)
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (comment)
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (out_param
        type: (parameter_type
          (primitive_type))
        name: (identifier)))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (integer)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (string))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (comment)
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)))))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)))))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)))))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (id_list
                    (identifier)
                    (identifier)))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)))))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (id_list
                    (identifier)
                    (identifier)))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier))))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (id_list
                    (identifier)
                    (identifier)))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))))
    (return_stm
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)))))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)
          help: (string)
          output_name: (string))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier)
          help: (string))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier))))))
    (retain_list
      name: (ref_exp
        (identifier))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)
          help: (string)
          output_name: (string)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)
          help: (string)
          output_name: (string)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)
          help: (string)
          output_name: (string))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)
          help: (string)
          output_name: (string))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)
          help: (string)
          output_name: (string))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)
          help: (string)
          output_name: (string)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)
          help: (string)
          output_name: (string))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)
          help: (string)
          output_name: (string)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer))))))
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (map_type
              (parameter_type
                (ref_list
                  (id_list
                    (identifier)
                    (identifier))))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)
          help: (string)
          output_name: (string))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)
          help: (string)
          output_name: (string)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)
          help: (string)
          output_name: (string))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (pipeline_declaration
    name: (identifier)
    parameters: (parameter_list
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (map_type
            (parameter_type
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (array_type
            (parameter_type
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (array_type
            (parameter_type
              (primitive_type))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (true)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (integer)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (false)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (integer)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (call_alias
        alias: (identifier))
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier))))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier))))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (map_exp
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (identifier)))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (identifier)))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (identifier)))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (identifier)))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (identifier)))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (identifier)))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (identifier)))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (comment)
              (pair
                key: (identifier)
                value: (expression
                  (null))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (comment)
      (comment)
      (comment)
      (comment)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (identifier))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (identifier))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (identifier))))
              (expression
                (ref_exp
                  (ref_list
                    (identifier))))
              (expression
                (ref_exp
                  (ref_list
                    (identifier))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier))))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier))))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (map_exp
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (identifier)))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (identifier))))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (return_stm
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (map_exp
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (map_exp
                    (pair
                      key: (identifier)
                      value: (expression
                        (ref_exp
                          (ref_list
                            (identifier)))))
                    (pair
                      key: (identifier)
                      value: (expression
                        (ref_exp
                          (ref_list
                            (identifier))))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (identifier)))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (identifier)))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (identifier)))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (identifier)))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (identifier)))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (identifier)))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier)))))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)))))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (pipeline_declaration
    name: (identifier)
    parameters: (parameter_list
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (array_type
            (parameter_type
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (map_type
            (parameter_type
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (primitive_type))
        name: (identifier)))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (call_alias
        alias: (identifier))
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (string)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (string)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (call_alias
        alias: (identifier))
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (string)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (string)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier))))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (ref_exp
                (ref_list
                  (id_list
                    (identifier)
                    (identifier)))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (return_stm
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier))))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (map_exp
              (pair
                key: (string)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier)
                        (identifier))))))
              (pair
                key: (string)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier)
                        (identifier)))))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)))))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (array_type
              (parameter_type
                (ref_list
                  (id_list
                    (identifier)
                    (identifier))))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (pipeline_declaration
    name: (identifier)
    parameters: (parameter_list
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)))
    (call_stm
      name: (identifier)
      (call_alias
        alias: (identifier))
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (call_alias
        alias: (identifier))
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (return_stm
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)))))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (primitive_type))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (comment)
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)
          help: (string)
          output_name: (string))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (comment)
  (pipeline_declaration
    name: (identifier)
    parameters: (parameter_list
      (in_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (array_type
            (parameter_type
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (array_type
            (parameter_type
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (array_type
            (parameter_type
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (array_type
            (parameter_type
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (array_type
            (parameter_type
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (array_type
            (parameter_type
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (array_type
            (parameter_type
              (identifier))))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (in_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (primitive_type))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier)
        help: (string)
        output_name: (string))
      (out_param
        type: (parameter_type
          (identifier))
        name: (identifier))
      (out_param
        type: (parameter_type
          (array_type
            (parameter_type
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (array_type
            (parameter_type
              (identifier))))
        name: (identifier))
      (out_param
        type: (parameter_type
          (primitive_type))
        name: (identifier))
      (out_param
        type: (parameter_type
          (ref_list
            (id_list
              (identifier)
              (identifier))))
        name: (identifier)))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier))))))
      (resources
        (resource_list
          (resource_binding
            resource: (resource_type)
            value: (resource_value
              (true))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (true)))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (false)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (integer)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier))))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (map_exp
                  (pair
                    key: (string)
                    value: (expression
                      (ref_exp
                        (ref_list
                          (id_list
                            (identifier)
                            (identifier)
                            (identifier))))))
                  (pair
                    key: (string)
                    value: (expression
                      (ref_exp
                        (ref_list
                          (id_list
                            (identifier)
                            (identifier))))))
                  (pair
                    key: (string)
                    value: (expression
                      (ref_exp
                        (ref_list
                          (id_list
                            (identifier)
                            (identifier))))))
                  (pair
                    key: (string)
                    value: (expression
                      (ref_exp
                        (ref_list
                          (id_list
                            (identifier)
                            (identifier)
                            (identifier))))))
                  (pair
                    key: (string)
                    value: (expression
                      (null)))
                  (pair
                    key: (string)
                    value: (expression
                      (null)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier))))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (map_exp
                  (pair
                    key: (string)
                    value: (expression
                      (null))))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier))))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (integer)))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (identifier)))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier))))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (false)))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))))
    (call_stm
      name: (identifier)
      (call_alias
        alias: (identifier))
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier))))))))))
    (call_stm
      name: (identifier)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier)))))
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier))))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (null)))))
    (return_stm
      (comment)
      (binding_list
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (map_exp
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier))))))
              (pair
                key: (identifier)
                value: (expression
                  (ref_exp
                    (ref_list
                      (id_list
                        (identifier)
                        (identifier)))))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (array_exp
              (expression
                (ref_exp
                  (ref_list
                    (id_list
                      (identifier)
                      (identifier))))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (binding
          target: (binding_target
            (identifier))
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier))))))
        (comment)
        (binding
          target: (binding_target)
          value: (expression
            (ref_exp
              (ref_list
                (id_list
                  (identifier)
                  (identifier)))))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (primitive_type))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (ref_list
                  (id_list
                    (identifier)
                    (identifier))))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (ref_list
                  (id_list
                    (identifier)
                    (identifier))))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (ref_list
                  (id_list
                    (identifier)
                    (identifier))))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (ref_list
                  (id_list
                    (identifier)
                    (identifier))))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (ref_list
                  (id_list
                    (identifier)
                    (identifier))))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list)
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (integer)))
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (stage_declaration
    name: (identifier)
    (stage_body
      (parameter_list
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (identifier))
          name: (identifier))
        (in_param
          type: (parameter_type
            (array_type
              (parameter_type
                (ref_list
                  (id_list
                    (identifier)
                    (identifier))))))
          name: (identifier))
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (map_type
              (parameter_type
                (identifier))))
          name: (identifier))
        (comment)
        (out_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))
        (out_param
          type: (parameter_type
            (identifier))
          name: (identifier)))
      (src_stm
        type: (src_lang)
        source_path: (string)))
    (split_param_list
      (parameter_list
        (in_param
          type: (parameter_type
            (ref_list
              (id_list
                (identifier)
                (identifier))))
          name: (identifier))))
    (resources
      (resource_list
        (resource_binding
          resource: (resource_type)
          value: (resource_value
            (ref_exp
              (identifier)))))))
  (comment)
  (comment)
  (comment)
  (call_stm
    name: (identifier)
    (binding_list
      (binding
        target: (binding_target
          (identifier))
        value: (expression
          (string)))
      (binding
        target: (binding_target
          (identifier))
        value: (expression
          (map_exp
            (pair
              key: (identifier)
              value: (expression
                (string)))
            (pair
              key: (identifier)
              value: (expression
                (string)))
            (pair
              key: (identifier)
              value: (expression
                (string)))
            (pair
              key: (identifier)
              value: (expression
                (string))))))
      (binding
        target: (binding_target
          (identifier))
        value: (expression
          (array_exp
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string)))))
      (binding
        target: (binding_target
          (identifier))
        value: (expression
          (array_exp
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string)))))
      (binding
        target: (binding_target
          (identifier))
        value: (expression
          (array_exp
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string)))))
      (binding
        target: (binding_target
          (identifier))
        value: (expression
          (array_exp
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string)))))
      (binding
        target: (binding_target
          (identifier))
        value: (expression
          (array_exp
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string))
            (expression
              (string)))))
      (binding
        target: (binding_target
          (identifier))
        value: (expression
          (array_exp
            (expression
              (map_exp
                (pair
                  key: (identifier)
                  value: (expression
                    (string)))
                (pair
                  key: (identifier)
                  value: (expression
                    (string)))
                (pair
                  key: (identifier)
                  value: (expression
                    (string)))
                (pair
                  key: (identifier)
                  value: (expression
                    (string)))
                (pair
                  key: (identifier)
                  value: (expression
                    (string)))
                (pair
                  key: (identifier)
                  value: (expression
                    (string)))
                (pair
                  key: (identifier)
                  value: (expression
                    (string)))
                (pair
                  key: (identifier)
                  value: (expression
                    (string)))))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null)))))
      (binding
        target: (binding_target
          (identifier))
        value: (expression
          (array_exp
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (map_exp
                (pair
                  key: (identifier)
                  value: (expression
                    (string)))
                (pair
                  key: (identifier)
                  value: (expression
                    (string)))
                (pair
                  key: (identifier)
                  value: (expression
                    (string)))
                (pair
                  key: (identifier)
                  value: (expression
                    (string)))
                (pair
                  key: (identifier)
                  value: (expression
                    (string)))
                (pair
                  key: (identifier)
                  value: (expression
                    (string)))))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null))
            (expression
              (null)))))
      (binding
        target: (binding_target
          (identifier))
        value: (expression
          (string)))
      (binding
        target: (binding_target
          (identifier))
        value: (expression
          (string)))
      (binding
        target: (binding_target
          (identifier))
        value: (expression
          (string))))))
